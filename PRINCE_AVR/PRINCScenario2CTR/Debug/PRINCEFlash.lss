
AVRASM ver. 2.1.57  K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm Tue Jul 21 11:23:04 2015

[builtin](2): Including file 'C:\Program Files (x86)\Atmel\Atmel Toolchain\AVR Assembler\Native\2.1.1175\avrassembler\Include\tn45def.inc'
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(21): Including file 'C:\Program Files (x86)\Atmel\Atmel Toolchain\AVR Assembler\Native\2.1.1175\avrassembler\Include\tn45def.inc'
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): Including file 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm'
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(37): warning: Register r16 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(38): warning: Register r17 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(39): warning: Register r18 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(40): warning: Register r19 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(41): warning: Register r20 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(42): warning: Register r21 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(46): warning: Register r0 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(47): warning: Register r1 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(48): warning: Register r2 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(49): warning: Register r3 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(50): warning: Register r4 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(51): warning: Register r5 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(52): warning: Register r6 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(53): warning: Register r7 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(59): warning: .def: 'XL' redefinition (r26->r26)
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(59): warning: Register r26 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(60): warning: .def: 'XH' redefinition (r27->r27)
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(60): warning: Register r27 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(61): warning: .def: 'YL' redefinition (r28->r28)
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(61): warning: Register r28 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(62): warning: .def: 'YH' redefinition (r29->r29)
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(62): warning: Register r29 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(63): warning: .def: 'ZL' redefinition (r30->r30)
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(63): warning: Register r30 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(64): warning: .def: 'ZH' redefinition (r31->r31)
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm(64): warning: Register r31 already defined by the .DEF directive
K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\interface.asm(50): 'K:\Seagate\PRINCE\PRINCE_AVR\PRINCEFlash\PRINCE128Flash.asm' included form here
                 
                 /*
                 
                 ;***** Created: 2011-02-09 12:04 ******* Source: ATtiny45.xml ************
                 ;*************************************************************************
                 ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
                 ;* 
                 ;* Number            : AVR000
                 ;* File Name         : "tn45def.inc"
                 ;* Title             : Register/Bit Definitions for the ATtiny45
                 ;* Date              : 2011-02-09
                 ;* Version           : 2.35
                 ;* Support E-mail    : avr@atmel.com
                 ;* Target MCU        : ATtiny45
                 ;* 
                 ;* DESCRIPTION
                 ;* When including this file in the assembly program file, all I/O register 
                 ;* names and I/O register bit names appearing in the data book can be used.
                 ;* In addition, the six registers forming the three data pointers X, Y and 
                 ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
                 ;* SRAM is also defined 
                 ;* 
                 ;* The Register names are represented by their hexadecimal address.
                 ;* 
                 ;* The Register Bit names are represented by their bit number (0-7).
                 ;* 
                 ;* Please observe the difference in using the bit names with instructions
                 ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
                 ;* (skip if bit in register set/cleared). The following example illustrates
                 ;* this:
                 ;* 
                 ;* in    r16,PORTB             ;read PORTB latch
                 ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
                 ;* out   PORTB,r16             ;output to PORTB
                 ;* 
                 ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
                 ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
                 ;* rjmp  TOV0_is_set           ;jump if set
                 ;* ...                         ;otherwise do something else
                 ;*************************************************************************
                 
                 #ifndef _TN45DEF_INC_
                 #define _TN45DEF_INC_
                 
                 
                 #pragma partinc 0
                 
                 ; ***** SPECIFY DEVICE ***************************************************
                 .device ATtiny45
                 #pragma AVRPART ADMIN PART_NAME ATtiny45
                 .equ	SIGNATURE_000	= 0x1e
                 .equ	SIGNATURE_001	= 0x92
                 .equ	SIGNATURE_002	= 0x06
                 
                 #pragma AVRPART CORE CORE_VERSION V2
                 #pragma AVRPART CORE NEW_INSTRUCTIONS lpm rd,z+
                 
                 
                 ; ***** I/O REGISTER DEFINITIONS *****************************************
                 ; NOTE:
                 ; Definitions marked "MEMORY MAPPED"are extended I/O ports
                 ; and cannot be used with IN/OUT instructions
                 .equ	SREG	= 0x3f
                 .equ	SPL	= 0x3d
                 .equ	SPH	= 0x3e
                 .equ	GIMSK	= 0x3b
                 .equ	GIFR	= 0x3a
                 .equ	TIMSK	= 0x39
                 .equ	TIFR	= 0x38
                 .equ	SPMCSR	= 0x37
                 .equ	MCUCR	= 0x35
                 .equ	MCUSR	= 0x34
                 .equ	TCCR0B	= 0x33
                 .equ	TCNT0	= 0x32
                 .equ	OSCCAL	= 0x31
                 .equ	TCCR1	= 0x30
                 .equ	TCNT1	= 0x2f
                 .equ	OCR1A	= 0x2e
                 .equ	OCR1C	= 0x2d
                 .equ	GTCCR	= 0x2c
                 .equ	OCR1B	= 0x2b
                 .equ	TCCR0A	= 0x2a
                 .equ	OCR0A	= 0x29
                 .equ	OCR0B	= 0x28
                 .equ	PLLCSR	= 0x27
                 .equ	CLKPR	= 0x26
                 .equ	DT1A	= 0x25
                 .equ	DT1B	= 0x24
                 .equ	DTPS	= 0x23
                 .equ	DWDR	= 0x22
                 .equ	WDTCR	= 0x21
                 .equ	PRR	= 0x20
                 .equ	EEARH	= 0x1f
                 .equ	EEARL	= 0x1e
                 .equ	EEDR	= 0x1d
                 .equ	EECR	= 0x1c
                 .equ	PORTB	= 0x18
                 .equ	DDRB	= 0x17
                 .equ	PINB	= 0x16
                 .equ	PCMSK	= 0x15
                 .equ	DIDR0	= 0x14
                 .equ	GPIOR2	= 0x13
                 .equ	GPIOR1	= 0x12
                 .equ	GPIOR0	= 0x11
                 .equ	USIBR	= 0x10
                 .equ	USIDR	= 0x0f
                 .equ	USISR	= 0x0e
                 .equ	USICR	= 0x0d
                 .equ	ACSR	= 0x08
                 .equ	ADMUX	= 0x07
                 .equ	ADCSRA	= 0x06
                 .equ	ADCH	= 0x05
                 .equ	ADCL	= 0x04
                 .equ	ADCSRB	= 0x03
                 
                 
                 ; ***** BIT DEFINITIONS **************************************************
                 
                 ; ***** PORTB ************************
                 ; PORTB - Data Register, Port B
                 .equ	PORTB0	= 0	; 
                 .equ	PB0	= 0	; For compatibility
                 .equ	PORTB1	= 1	; 
                 .equ	PB1	= 1	; For compatibility
                 .equ	PORTB2	= 2	; 
                 .equ	PB2	= 2	; For compatibility
                 .equ	PORTB3	= 3	; 
                 .equ	PB3	= 3	; For compatibility
                 .equ	PORTB4	= 4	; 
                 .equ	PB4	= 4	; For compatibility
                 .equ	PORTB5	= 5	; 
                 .equ	PB5	= 5	; For compatibility
                 
                 ; DDRB - Data Direction Register, Port B
                 .equ	DDB0	= 0	; 
                 .equ	DDB1	= 1	; 
                 .equ	DDB2	= 2	; 
                 .equ	DDB3	= 3	; 
                 .equ	DDB4	= 4	; 
                 .equ	DDB5	= 5	; 
                 
                 ; PINB - Input Pins, Port B
                 .equ	PINB0	= 0	; 
                 .equ	PINB1	= 1	; 
                 .equ	PINB2	= 2	; 
                 .equ	PINB3	= 3	; 
                 .equ	PINB4	= 4	; 
                 .equ	PINB5	= 5	; 
                 
                 
                 ; ***** ANALOG_COMPARATOR ************
                 ; ADCSRB - ADC Control and Status Register B
                 .equ	ACME	= 6	; Analog Comparator Multiplexer Enable
                 
                 ; ACSR - Analog Comparator Control And Status Register
                 .equ	ACIS0	= 0	; Analog Comparator Interrupt Mode Select bit 0
                 .equ	ACIS1	= 1	; Analog Comparator Interrupt Mode Select bit 1
                 .equ	ACIE	= 3	; Analog Comparator Interrupt Enable
                 .equ	ACI	= 4	; Analog Comparator Interrupt Flag
                 .equ	ACO	= 5	; Analog Compare Output
                 .equ	ACBG	= 6	; Analog Comparator Bandgap Select
                 .equ	AINBG	= ACBG	; For compatibility
                 .equ	ACD	= 7	; Analog Comparator Disable
                 
                 ; DIDR0 - 
                 .equ	AIN0D	= 0	; AIN0 Digital Input Disable
                 .equ	AIN1D	= 1	; AIN1 Digital Input Disable
                 
                 
                 ; ***** AD_CONVERTER *****************
                 ; ADMUX - The ADC multiplexer Selection Register
                 .equ	MUX0	= 0	; Analog Channel and Gain Selection Bits
                 .equ	MUX1	= 1	; Analog Channel and Gain Selection Bits
                 .equ	MUX2	= 2	; Analog Channel and Gain Selection Bits
                 .equ	MUX3	= 3	; Analog Channel and Gain Selection Bits
                 .equ	REFS2	= 4	; Reference Selection Bit 2
                 .equ	ADLAR	= 5	; Left Adjust Result
                 .equ	REFS0	= 6	; Reference Selection Bit 0
                 .equ	REFS1	= 7	; Reference Selection Bit 1
                 
                 ; ADCSRA - The ADC Control and Status register
                 .equ	ADPS0	= 0	; ADC  Prescaler Select Bits
                 .equ	ADPS1	= 1	; ADC  Prescaler Select Bits
                 .equ	ADPS2	= 2	; ADC  Prescaler Select Bits
                 .equ	ADIE	= 3	; ADC Interrupt Enable
                 .equ	ADIF	= 4	; ADC Interrupt Flag
                 .equ	ADATE	= 5	; ADC Auto Trigger Enable
                 .equ	ADSC	= 6	; ADC Start Conversion
                 .equ	ADEN	= 7	; ADC Enable
                 
                 ; ADCH - ADC Data Register High Byte
                 .equ	ADCH0	= 0	; ADC Data Register High Byte Bit 0
                 .equ	ADCH1	= 1	; ADC Data Register High Byte Bit 1
                 .equ	ADCH2	= 2	; ADC Data Register High Byte Bit 2
                 .equ	ADCH3	= 3	; ADC Data Register High Byte Bit 3
                 .equ	ADCH4	= 4	; ADC Data Register High Byte Bit 4
                 .equ	ADCH5	= 5	; ADC Data Register High Byte Bit 5
                 .equ	ADCH6	= 6	; ADC Data Register High Byte Bit 6
                 .equ	ADCH7	= 7	; ADC Data Register High Byte Bit 7
                 
                 ; ADCL - ADC Data Register Low Byte
                 .equ	ADCL0	= 0	; ADC Data Register Low Byte Bit 0
                 .equ	ADCL1	= 1	; ADC Data Register Low Byte Bit 1
                 .equ	ADCL2	= 2	; ADC Data Register Low Byte Bit 2
                 .equ	ADCL3	= 3	; ADC Data Register Low Byte Bit 3
                 .equ	ADCL4	= 4	; ADC Data Register Low Byte Bit 4
                 .equ	ADCL5	= 5	; ADC Data Register Low Byte Bit 5
                 .equ	ADCL6	= 6	; ADC Data Register Low Byte Bit 6
                 .equ	ADCL7	= 7	; ADC Data Register Low Byte Bit 7
                 
                 ; ADCSRB - ADC Control and Status Register B
                 .equ	ADTS0	= 0	; ADC Auto Trigger Source 0
                 .equ	ADTS1	= 1	; ADC Auto Trigger Source 1
                 .equ	ADTS2	= 2	; ADC Auto Trigger Source 2
                 .equ	IPR	= 5	; Input Polarity Mode
                 .equ	BIN	= 7	; Bipolar Input Mode
                 
                 ; DIDR0 - Digital Input Disable Register 0
                 .equ	ADC1D	= 2	; ADC1 Digital input Disable
                 .equ	ADC3D	= 3	; ADC3 Digital input Disable
                 .equ	ADC2D	= 4	; ADC2 Digital input Disable
                 .equ	ADC0D	= 5	; ADC0 Digital input Disable
                 
                 
                 ; ***** USI **************************
                 ; USIBR - USI Buffer Register
                 .equ	USIBR0	= 0	; USI Buffer Register bit 0
                 .equ	USIBR1	= 1	; USI Buffer Register bit 1
                 .equ	USIBR2	= 2	; USI Buffer Register bit 2
                 .equ	USIBR3	= 3	; USI Buffer Register bit 3
                 .equ	USIBR4	= 4	; USI Buffer Register bit 4
                 .equ	USIBR5	= 5	; USI Buffer Register bit 5
                 .equ	USIBR6	= 6	; USI Buffer Register bit 6
                 .equ	USIBR7	= 7	; USI Buffer Register bit 7
                 
                 ; USIDR - USI Data Register
                 .equ	USIDR0	= 0	; USI Data Register bit 0
                 .equ	USIDR1	= 1	; USI Data Register bit 1
                 .equ	USIDR2	= 2	; USI Data Register bit 2
                 .equ	USIDR3	= 3	; USI Data Register bit 3
                 .equ	USIDR4	= 4	; USI Data Register bit 4
                 .equ	USIDR5	= 5	; USI Data Register bit 5
                 .equ	USIDR6	= 6	; USI Data Register bit 6
                 .equ	USIDR7	= 7	; USI Data Register bit 7
                 
                 ; USISR - USI Status Register
                 .equ	USICNT0	= 0	; USI Counter Value Bit 0
                 .equ	USICNT1	= 1	; USI Counter Value Bit 1
                 .equ	USICNT2	= 2	; USI Counter Value Bit 2
                 .equ	USICNT3	= 3	; USI Counter Value Bit 3
                 .equ	USIDC	= 4	; Data Output Collision
                 .equ	USIPF	= 5	; Stop Condition Flag
                 .equ	USIOIF	= 6	; Counter Overflow Interrupt Flag
                 .equ	USISIF	= 7	; Start Condition Interrupt Flag
                 
                 ; USICR - USI Control Register
                 .equ	USITC	= 0	; Toggle Clock Port Pin
                 .equ	USICLK	= 1	; Clock Strobe
                 .equ	USICS0	= 2	; USI Clock Source Select Bit 0
                 .equ	USICS1	= 3	; USI Clock Source Select Bit 1
                 .equ	USIWM0	= 4	; USI Wire Mode Bit 0
                 .equ	USIWM1	= 5	; USI Wire Mode Bit 1
                 .equ	USIOIE	= 6	; Counter Overflow Interrupt Enable
                 .equ	USISIE	= 7	; Start Condition Interrupt Enable
                 
                 
                 ; ***** EXTERNAL_INTERRUPT ***********
                 ; MCUCR - MCU Control Register
                 .equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
                 .equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
                 
                 ; GIMSK - General Interrupt Mask Register
                 .equ	GICR	= GIMSK	; For compatibility
                 .equ	PCIE	= 5	; Pin Change Interrupt Enable
                 .equ	INT0	= 6	; External Interrupt Request 0 Enable
                 
                 ; GIFR - General Interrupt Flag register
                 .equ	PCIF	= 5	; Pin Change Interrupt Flag
                 .equ	INTF0	= 6	; External Interrupt Flag 0
                 
                 ; PCMSK - Pin Change Enable Mask
                 .equ	PCINT0	= 0	; Pin Change Enable Mask Bit 0
                 .equ	PCINT1	= 1	; Pin Change Enable Mask Bit 1
                 .equ	PCINT2	= 2	; Pin Change Enable Mask Bit 2
                 .equ	PCINT3	= 3	; Pin Change Enable Mask Bit 3
                 .equ	PCINT4	= 4	; Pin Change Enable Mask Bit 4
                 .equ	PCINT5	= 5	; Pin Change Enable Mask Bit 5
                 
                 
                 ; ***** EEPROM ***********************
                 ; EEARL - EEPROM Address Register Low Byte
                 .equ	EEAR0	= 0	; EEPROM Read/Write Access Bit 0
                 .equ	EEAR1	= 1	; EEPROM Read/Write Access Bit 1
                 .equ	EEAR2	= 2	; EEPROM Read/Write Access Bit 2
                 .equ	EEAR3	= 3	; EEPROM Read/Write Access Bit 3
                 .equ	EEAR4	= 4	; EEPROM Read/Write Access Bit 4
                 .equ	EEAR5	= 5	; EEPROM Read/Write Access Bit 5
                 .equ	EEAR6	= 6	; EEPROM Read/Write Access Bit 6
                 .equ	EEAR7	= 7	; EEPROM Read/Write Access Bit 7
                 
                 ; EEARH - EEPROM Address Register High Byte
                 .equ	EEAR8	= 0	; EEPROM Read/Write Access Bit 0
                 
                 ; EEDR - EEPROM Data Register
                 .equ	EEDR0	= 0	; EEPROM Data Register bit 0
                 .equ	EEDR1	= 1	; EEPROM Data Register bit 1
                 .equ	EEDR2	= 2	; EEPROM Data Register bit 2
                 .equ	EEDR3	= 3	; EEPROM Data Register bit 3
                 .equ	EEDR4	= 4	; EEPROM Data Register bit 4
                 .equ	EEDR5	= 5	; EEPROM Data Register bit 5
                 .equ	EEDR6	= 6	; EEPROM Data Register bit 6
                 .equ	EEDR7	= 7	; EEPROM Data Register bit 7
                 
                 ; EECR - EEPROM Control Register
                 .equ	EERE	= 0	; EEPROM Read Enable
                 .equ	EEPE	= 1	; EEPROM Write Enable
                 .equ	EEMPE	= 2	; EEPROM Master Write Enable
                 .equ	EERIE	= 3	; EEPROM Ready Interrupt Enable
                 .equ	EEPM0	= 4	; EEPROM Programming Mode Bit 0
                 .equ	EEPM1	= 5	; EEPROM Programming Mode Bit 1
                 
                 
                 ; ***** WATCHDOG *********************
                 ; WDTCR - Watchdog Timer Control Register
                 .equ	WDTCSR	= WDTCR	; For compatibility
                 .equ	WDP0	= 0	; Watch Dog Timer Prescaler bit 0
                 .equ	WDP1	= 1	; Watch Dog Timer Prescaler bit 1
                 .equ	WDP2	= 2	; Watch Dog Timer Prescaler bit 2
                 .equ	WDE	= 3	; Watch Dog Enable
                 .equ	WDCE	= 4	; Watchdog Change Enable
                 .equ	WDTOE	= WDCE	; For compatibility
                 .equ	WDP3	= 5	; Watchdog Timer Prescaler Bit 3
                 .equ	WDIE	= 6	; Watchdog Timeout Interrupt Enable
                 .equ	WDIF	= 7	; Watchdog Timeout Interrupt Flag
                 
                 
                 ; ***** TIMER_COUNTER_0 **************
                 ; TIMSK - Timer/Counter Interrupt Mask Register
                 .equ	TOIE0	= 1	; Timer/Counter0 Overflow Interrupt Enable
                 .equ	OCIE0B	= 3	; Timer/Counter0 Output Compare Match B Interrupt Enable
                 .equ	OCIE0A	= 4	; Timer/Counter0 Output Compare Match A Interrupt Enable
                 
                 ; TIFR - Timer/Counter0 Interrupt Flag register
                 .equ	TOV0	= 1	; Timer/Counter0 Overflow Flag
                 .equ	OCF0B	= 3	; Timer/Counter0 Output Compare Flag 0B
                 .equ	OCF0A	= 4	; Timer/Counter0 Output Compare Flag 0A
                 
                 ; TCCR0A - Timer/Counter  Control Register A
                 .equ	WGM00	= 0	; Waveform Generation Mode
                 .equ	WGM01	= 1	; Waveform Generation Mode
                 .equ	COM0B0	= 4	; Compare Output Mode, Fast PWm
                 .equ	COM0B1	= 5	; Compare Output Mode, Fast PWm
                 .equ	COM0A0	= 6	; Compare Output Mode, Phase Correct PWM Mode
                 .equ	COM0A1	= 7	; Compare Output Mode, Phase Correct PWM Mode
                 
                 ; TCCR0B - Timer/Counter Control Register B
                 .equ	CS00	= 0	; Clock Select
                 .equ	CS01	= 1	; Clock Select
                 .equ	CS02	= 2	; Clock Select
                 .equ	WGM02	= 3	; 
                 .equ	FOC0B	= 6	; Force Output Compare B
                 .equ	FOC0A	= 7	; Force Output Compare A
                 
                 ; TCNT0 - Timer/Counter0
                 .equ	TCNT0_0	= 0	; 
                 .equ	TCNT0_1	= 1	; 
                 .equ	TCNT0_2	= 2	; 
                 .equ	TCNT0_3	= 3	; 
                 .equ	TCNT0_4	= 4	; 
                 .equ	TCNT0_5	= 5	; 
                 .equ	TCNT0_6	= 6	; 
                 .equ	TCNT0_7	= 7	; 
                 
                 ; OCR0A - Timer/Counter0 Output Compare Register
                 .equ	OCR0_0	= 0	; 
                 .equ	OCR0_1	= 1	; 
                 .equ	OCR0_2	= 2	; 
                 .equ	OCR0_3	= 3	; 
                 .equ	OCR0_4	= 4	; 
                 .equ	OCR0_5	= 5	; 
                 .equ	OCR0_6	= 6	; 
                 .equ	OCR0_7	= 7	; 
                 
                 ; OCR0B - Timer/Counter0 Output Compare Register
                 ;.equ	OCR0_0	= 0	; 
                 ;.equ	OCR0_1	= 1	; 
                 ;.equ	OCR0_2	= 2	; 
                 ;.equ	OCR0_3	= 3	; 
                 ;.equ	OCR0_4	= 4	; 
                 ;.equ	OCR0_5	= 5	; 
                 ;.equ	OCR0_6	= 6	; 
                 ;.equ	OCR0_7	= 7	; 
                 
                 ; GTCCR - General Timer/Counter Control Register
                 .equ	PSR0	= 0	; Prescaler Reset Timer/Counter1 and Timer/Counter0
                 .equ	TSM	= 7	; Timer/Counter Synchronization Mode
                 
                 
                 ; ***** TIMER_COUNTER_1 **************
                 ; TCCR1 - Timer/Counter Control Register
                 .equ	CS10	= 0	; Clock Select Bits
                 .equ	CS11	= 1	; Clock Select Bits
                 .equ	CS12	= 2	; Clock Select Bits
                 .equ	CS13	= 3	; Clock Select Bits
                 .equ	COM1A0	= 4	; Compare Output Mode, Bit 1
                 .equ	COM1A1	= 5	; Compare Output Mode, Bit 0
                 .equ	PWM1A	= 6	; Pulse Width Modulator Enable
                 .equ	CTC1	= 7	; Clear Timer/Counter on Compare Match
                 
                 ; TCNT1 - Timer/Counter Register
                 .equ	TCNT1_0	= 0	; Timer/Counter Register Bit 0
                 .equ	TCNT1_1	= 1	; Timer/Counter Register Bit 1
                 .equ	TCNT1_2	= 2	; Timer/Counter Register Bit 2
                 .equ	TCNT1_3	= 3	; Timer/Counter Register Bit 3
                 .equ	TCNT1_4	= 4	; Timer/Counter Register Bit 4
                 .equ	TCNT1_5	= 5	; Timer/Counter Register Bit 5
                 .equ	TCNT1_6	= 6	; Timer/Counter Register Bit 6
                 .equ	TCNT1_7	= 7	; Timer/Counter Register Bit 7
                 
                 ; OCR1A - Output Compare Register
                 .equ	OCR1A0	= 0	; Output Compare Register A Bit 0
                 .equ	OCR1A1	= 1	; Output Compare Register A Bit 1
                 .equ	OCR1A2	= 2	; Output Compare Register A Bit 2
                 .equ	OCR1A3	= 3	; Output Compare Register A Bit 3
                 .equ	OCR1A4	= 4	; Output Compare Register A Bit 4
                 .equ	OCR1A5	= 5	; Output Compare Register A Bit 5
                 .equ	OCR1A6	= 6	; Output Compare Register A Bit 6
                 .equ	OCR1A7	= 7	; Output Compare Register A Bit 7
                 
                 ; OCR1B - Output Compare Register
                 .equ	OCR1B0	= 0	; Output Compare Register B Bit 0
                 .equ	OCR1B1	= 1	; Output Compare Register B Bit 1
                 .equ	OCR1B2	= 2	; Output Compare Register B Bit 2
                 .equ	OCR1B3	= 3	; Output Compare Register B Bit 3
                 .equ	OCR1B4	= 4	; Output Compare Register B Bit 4
                 .equ	OCR1B5	= 5	; Output Compare Register B Bit 5
                 .equ	OCR1B6	= 6	; Output Compare Register B Bit 6
                 .equ	OCR1B7	= 7	; Output Compare Register B Bit 7
                 
                 ; OCR1C - Output compare register
                 .equ	OCR1C0	= 0	; 
                 .equ	OCR1C1	= 1	; 
                 .equ	OCR1C2	= 2	; 
                 .equ	OCR1C3	= 3	; 
                 .equ	OCR1C4	= 4	; 
                 .equ	OCR1C5	= 5	; 
                 .equ	OCR1C6	= 6	; 
                 .equ	OCR1C7	= 7	; 
                 
                 ; TIMSK - Timer/Counter Interrupt Mask Register
                 .equ	TOIE1	= 2	; Timer/Counter1 Overflow Interrupt Enable
                 .equ	OCIE1B	= 5	; OCIE1A: Timer/Counter1 Output Compare B Interrupt Enable
                 .equ	OCIE1A	= 6	; OCIE1A: Timer/Counter1 Output Compare Interrupt Enable
                 
                 ; TIFR - Timer/Counter Interrupt Flag Register
                 .equ	TOV1	= 2	; Timer/Counter1 Overflow Flag
                 .equ	OCF1B	= 5	; Timer/Counter1 Output Compare Flag 1B
                 .equ	OCF1A	= 6	; Timer/Counter1 Output Compare Flag 1A
                 
                 ; GTCCR - Timer counter control register
                 .equ	PSR1	= 1	; Prescaler Reset Timer/Counter1
                 .equ	FOC1A	= 2	; Force Output Compare 1A
                 .equ	FOC1B	= 3	; Force Output Compare Match 1B
                 .equ	COM1B0	= 4	; Comparator B Output Mode
                 .equ	COM1B1	= 5	; Comparator B Output Mode
                 .equ	PWM1B	= 6	; Pulse Width Modulator B Enable
                 
                 ; DTPS - Dead time prescaler register
                 .equ	DTPS0	= 0	; 
                 .equ	DTPS1	= 1	; 
                 
                 ; DT1A - Dead time value register
                 .equ	DTVL0	= 0	; 
                 .equ	DTVL1	= 1	; 
                 .equ	DTVL2	= 2	; 
                 .equ	DTVL3	= 3	; 
                 .equ	DTVH0	= 4	; 
                 .equ	DTVH1	= 5	; 
                 .equ	DTVH2	= 6	; 
                 .equ	DTVH3	= 7	; 
                 
                 ; DT1B - Dead time value B
                 ;.equ	DTVL0	= 0	; 
                 ;.equ	DTVL1	= 1	; 
                 ;.equ	DTVL2	= 2	; 
                 ;.equ	DTVL3	= 3	; 
                 ;.equ	DTVH0	= 4	; 
                 ;.equ	DTVH1	= 5	; 
                 ;.equ	DTVH2	= 6	; 
                 ;.equ	DTVH3	= 7	; 
                 
                 
                 ; ***** CPU **************************
                 ; SREG - Status Register
                 .equ	SREG_C	= 0	; Carry Flag
                 .equ	SREG_Z	= 1	; Zero Flag
                 .equ	SREG_N	= 2	; Negative Flag
                 .equ	SREG_V	= 3	; Two's Complement Overflow Flag
                 .equ	SREG_S	= 4	; Sign Bit
                 .equ	SREG_H	= 5	; Half Carry Flag
                 .equ	SREG_T	= 6	; Bit Copy Storage
                 .equ	SREG_I	= 7	; Global Interrupt Enable
                 
                 ; MCUCR - MCU Control Register
                 ;.equ	ISC00	= 0	; Interrupt Sense Control 0 bit 0
                 ;.equ	ISC01	= 1	; Interrupt Sense Control 0 bit 1
                 .equ	BODSE	= 2	; BOD Sleep Enable
                 .equ	SM0	= 3	; Sleep Mode Select Bit 0
                 .equ	SM1	= 4	; Sleep Mode Select Bit 1
                 .equ	SE	= 5	; Sleep Enable
                 .equ	PUD	= 6	; Pull-up Disable
                 .equ	BODS	= 7	; BOD Sleep
                 
                 ; MCUSR - MCU Status register
                 .equ	PORF	= 0	; Power-On Reset Flag
                 .equ	EXTRF	= 1	; External Reset Flag
                 .equ	BORF	= 2	; Brown-out Reset Flag
                 .equ	WDRF	= 3	; Watchdog Reset Flag
                 
                 ; PRR - Power Reduction Register
                 .equ	PRADC	= 0	; Power Reduction ADC
                 .equ	PRUSI	= 1	; Power Reduction USI
                 .equ	PRTIM0	= 2	; Power Reduction Timer/Counter0
                 .equ	PRTIM1	= 3	; Power Reduction Timer/Counter1
                 
                 ; OSCCAL - Oscillator Calibration Register
                 .equ	CAL0	= 0	; Oscillatro Calibration Value Bit 0
                 .equ	CAL1	= 1	; Oscillatro Calibration Value Bit 1
                 .equ	CAL2	= 2	; Oscillatro Calibration Value Bit 2
                 .equ	CAL3	= 3	; Oscillatro Calibration Value Bit 3
                 .equ	CAL4	= 4	; Oscillatro Calibration Value Bit 4
                 .equ	CAL5	= 5	; Oscillatro Calibration Value Bit 5
                 .equ	CAL6	= 6	; Oscillatro Calibration Value Bit 6
                 .equ	CAL7	= 7	; Oscillatro Calibration Value Bit 7
                 
                 ; PLLCSR - PLL Control and status register
                 .equ	PLOCK	= 0	; PLL Lock detector
                 .equ	PLLE	= 1	; PLL Enable
                 .equ	PCKE	= 2	; PCK Enable
                 .equ	LSM	= 7	; Low speed mode
                 
                 ; CLKPR - Clock Prescale Register
                 .equ	CLKPS0	= 0	; Clock Prescaler Select Bit 0
                 .equ	CLKPS1	= 1	; Clock Prescaler Select Bit 1
                 .equ	CLKPS2	= 2	; Clock Prescaler Select Bit 2
                 .equ	CLKPS3	= 3	; Clock Prescaler Select Bit 3
                 .equ	CLKPCE	= 7	; Clock Prescaler Change Enable
                 
                 ; DWDR - debugWire data register
                 .equ	DWDR0	= 0	; 
                 .equ	DWDR1	= 1	; 
                 .equ	DWDR2	= 2	; 
                 .equ	DWDR3	= 3	; 
                 .equ	DWDR4	= 4	; 
                 .equ	DWDR5	= 5	; 
                 .equ	DWDR6	= 6	; 
                 .equ	DWDR7	= 7	; 
                 
                 ; GPIOR2 - General Purpose IO register 2
                 .equ	GPIOR20	= 0	; 
                 .equ	GPIOR21	= 1	; 
                 .equ	GPIOR22	= 2	; 
                 .equ	GPIOR23	= 3	; 
                 .equ	GPIOR24	= 4	; 
                 .equ	GPIOR25	= 5	; 
                 .equ	GPIOR26	= 6	; 
                 .equ	GPIOR27	= 7	; 
                 
                 ; GPIOR1 - General Purpose register 1
                 .equ	GPIOR10	= 0	; 
                 .equ	GPIOR11	= 1	; 
                 .equ	GPIOR12	= 2	; 
                 .equ	GPIOR13	= 3	; 
                 .equ	GPIOR14	= 4	; 
                 .equ	GPIOR15	= 5	; 
                 .equ	GPIOR16	= 6	; 
                 .equ	GPIOR17	= 7	; 
                 
                 ; GPIOR0 - General purpose register 0
                 .equ	GPIOR00	= 0	; 
                 .equ	GPIOR01	= 1	; 
                 .equ	GPIOR02	= 2	; 
                 .equ	GPIOR03	= 3	; 
                 .equ	GPIOR04	= 4	; 
                 .equ	GPIOR05	= 5	; 
                 .equ	GPIOR06	= 6	; 
                 .equ	GPIOR07	= 7	; 
                 
                 
                 ; ***** BOOT_LOAD ********************
                 ; SPMCSR - Store Program Memory Control Register
                 .equ	SPMEN	= 0	; Store Program Memory Enable
                 .equ	PGERS	= 1	; Page Erase
                 .equ	PGWRT	= 2	; Page Write
                 .equ	RFLB	= 3	; Read fuse and lock bits
                 .equ	CTPB	= 4	; Clear temporary page buffer
                 
                 
                 
                 ; ***** LOCKSBITS ********************************************************
                 .equ	LB1	= 0	; Lockbit
                 .equ	LB2	= 1	; Lockbit
                 
                 
                 ; ***** FUSES ************************************************************
                 ; LOW fuse bits
                 .equ	CKSEL0	= 0	; Select Clock source
                 .equ	CKSEL1	= 1	; Select Clock source
                 .equ	CKSEL2	= 2	; Select Clock source
                 .equ	CKSEL3	= 3	; Select Clock source
                 .equ	SUT0	= 4	; Select start-up time
                 .equ	SUT1	= 5	; Select start-up time
                 .equ	CKOUT	= 6	; Clock Output Enable
                 .equ	CKDIV8	= 7	; Divide clock by 8
                 
                 ; HIGH fuse bits
                 .equ	BODLEVEL0	= 0	; Brown-out Detector trigger level
                 .equ	BODLEVEL1	= 1	; Brown-out Detector trigger level
                 .equ	BODLEVEL2	= 2	; Brown-out Detector trigger level
                 .equ	EESAVE	= 3	; EEPROM memory is preserved through the Chip Erase
                 .equ	WDTON	= 4	; Watchdog Timer always on
                 .equ	SPIEN	= 5	; Enable Serial Program and Data Downloading
                 .equ	DWEN	= 6	; DebugWIRE Enable
                 .equ	RSTDISBL	= 7	; External Reset disable
                 
                 ; EXTENDED fuse bits
                 .equ	SELFPRGEN	= 0	; Self-Programming Enable
                 
                 
                 
                 ; ***** CPU REGISTER DEFINITIONS *****************************************
                 .def	XH	= r27
                 .def	XL	= r26
                 .def	YH	= r29
                 .def	YL	= r28
                 .def	ZH	= r31
                 .def	ZL	= r30
                 
                 
                 
                 ; ***** DATA MEMORY DECLARATIONS *****************************************
                 .equ	FLASHEND	= 0x07ff	; Note: Word address
                 .equ	IOEND	= 0x003f
                 .equ	SRAM_START	= 0x0060
                 .equ	SRAM_SIZE	= 256
                 .equ	RAMEND	= 0x015f
                 .equ	XRAMEND	= 0x0000
                 .equ	E2END	= 0x00ff
                 .equ	EEPROMEND	= 0x00ff
                 .equ	EEADRBITS	= 8
                 #pragma AVRPART MEMORY PROG_FLASH 4096
                 #pragma AVRPART MEMORY EEPROM 256
                 #pragma AVRPART MEMORY INT_SRAM SIZE 256
                 #pragma AVRPART MEMORY INT_SRAM START_ADDR 0x60
                 
                 
                 
                 ; ***** BOOTLOADER DECLARATIONS ******************************************
                 .equ	NRWW_START_ADDR	= 0x0
                 .equ	NRWW_STOP_ADDR	= 0x7ff
                 .equ	RWW_START_ADDR	= 0x0
                 .equ	RWW_STOP_ADDR	= 0x0
                 .equ	PAGESIZE	= 32
                 
                 
                 
                 ; ***** INTERRUPT VECTORS ************************************************
                 .equ	INT0addr	= 0x0001	; External Interrupt 0
                 .equ	PCI0addr	= 0x0002	; Pin change Interrupt Request 0
                 .equ	OC1Aaddr	= 0x0003	; Timer/Counter1 Compare Match 1A
                 .equ	OVF1addr	= 0x0004	; Timer/Counter1 Overflow
                 .equ	OVF0addr	= 0x0005	; Timer/Counter0 Overflow
                 .equ	ERDYaddr	= 0x0006	; EEPROM Ready
                 .equ	ACIaddr	= 0x0007	; Analog comparator
                 .equ	ADCCaddr	= 0x0008	; ADC Conversion ready
                 .equ	OC1Baddr	= 0x0009	; Timer/Counter1 Compare Match B
                 .equ	OC0Aaddr	= 0x000a	; Timer/Counter0 Compare Match A
                 .equ	OC0Baddr	= 0x000b	; Timer/Counter0 Compare Match B
                 .equ	WDTaddr	= 0x000c	; Watchdog Time-out
                 .equ	USI_STARTaddr	= 0x000d	; USI START
                 .equ	USI_OVFaddr	= 0x000e	; USI Overflow
                 
                 .equ	INT_VECTORS_SIZE	= 15	; size in words
                 
                 #endif  /* _TN45DEF_INC_ */
                 
                 ; ***** END OF FILE ******************************************************
                 
                  * interface.asm
                  *
                  *  Created: 2015/4/23 23:35:49
                  *   Author: nevermore
                  */ 
                 
                 
                  /*
                  * interface.asm
                  *
                  *  Created: 2015/4/22 11:35:06
                  *   Author: Zheng Gong
                  */ 
                  ; encrypt_main_tiny45 : generates the plain text and key internally,
                 ; sends a trigger, encrypts and sends a second trigger
                 ; based on http://point-at-infinity.org/avraes/rijndaelfurious.asm.html
                 
                 ; modify the interface by humuchuang because the label "SRAM_DATA" cannot be recognized by the file KLEIN.asm
                 
                 .include "tn45def.inc"
                 
                 ;***** Created: 2011-02-09 12:04 ******* Source: ATtiny45.xml ************
                 ;*************************************************************************
                 ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
                 ;* 
                 ;* Number            : AVR000
                 ;* File Name         : "tn45def.inc"
                 ;* Title             : Register/Bit Definitions for the ATtiny45
                 ;* Date              : 2011-02-09
                 ;* Version           : 2.35
                 ;* Support E-mail    : avr@atmel.com
                 ;* Target MCU        : ATtiny45
                 ;* 
                 ;* DESCRIPTION
                 ;* When including this file in the assembly program file, all I/O register 
                 ;* names and I/O register bit names appearing in the data book can be used.
                 ;* In addition, the six registers forming the three data pointers X, Y and 
                 ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
                 ;* SRAM is also defined 
                 ;* 
                 ;* The Register names are represented by their hexadecimal address.
                 ;* 
                 ;* The Register Bit names are represented by their bit number (0-7).
                 ;* 
                 ;* Please observe the difference in using the bit names with instructions
                 ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
                 ;* (skip if bit in register set/cleared). The following example illustrates
                 ;* this:
                 ;* 
                 ;* in    r16,PORTB             ;read PORTB latch
                 ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
                 ;* out   PORTB,r16             ;output to PORTB
                 ;* 
                 ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
                 ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
                 ;* rjmp  TOV0_is_set           ;jump if set
                 ;* ...                         ;otherwise do something else
                 ;*************************************************************************
                 
                 #ifndef _TN45DEF_INC_
                 #endif  /* _TN45DEF_INC_ */
                 
                 ; ***** END OF FILE ******************************************************
                 
                 ; Define the cipher to include here (#define <cipher>)
                 #define	rectangle;(currently works for aes, desxl, hight, idea, kasumi, katan, klein, mcrypton, noekeon, present, sea, tea)
                 
                 
                 .ORG 0x0000
                 ; global interrupt disable
000000 94f8      	cli
                 ; initialize stack
000001 e0f1      	ldi		r31,HIGH(RAMEND)
000002 bffe      	out		SPH,r31
000003 e5ff      	ldi		r31,LOW(RAMEND)
000004 bffd      	out		SPL,r31
                 
                 ; initialize trigger B1
000005 e003        	ldi		r16, 0b11	; portB,1 = output (triggers)
000006 bb07        	out		DDRB, r16
                 
000007 c6e0      	rjmp	main
                 
                 
                 ;******************* INCLUDE FILES *******************************
                 ; include encryption algorithm
                 #ifdef	aes
                 #elif aesfurious
                 #elif rectangle
                     .include "PRINCE128Flash.asm";"./Rectangle128OnTheFly.asm";"Rectangle80.asm"
                 
                 ; Constants
                 ;
                 .EQU    PTEXT_NUM_BYTE = (8*8)
                 
                 .EQU    KEY0_NUM_BYTE = 8
                 .EQU    KEY1_NUM_BYTE = (8*12)
                 
                 #define KEYSCHEDULE
                 #define ENCRYPT
                 
                 ; Registers declarations
                 .def row00 =r0
                 .def row10 =r1
                 .def row20 =r2
                 .def row30 =r3
                 .def row01 =r4
                 .def row11 =r5
                 .def row21 =r6
                 .def row31 =r7
                 .def row02 =r8
                 .def row12 =r9
                 .def row22 =r10
                 .def row32 =r11
                 .def row03 =r12
                 .def row13 =r13
                 .def row23 =r14
                 .def row33 =r15
                 
                 .def t0 =r16
                 .def t1 =r17
                 .def t2 =r18
                 .def t3 =r19
                 .def t4 =r20
                 .def t5 =r21
                 
                 .def k0 =r16
                 .def k1 =r17
                 .def k2 =r18
                 .def k3 =r19
                 .def k4 =r20
                 .def k5 =r21
                 .def k6 =r22
                 .def k7 =r23
                 
                 .def kt0 =r0
                 .def kt1 =r1
                 .def kt2 =r2
                 .def kt3 =r3
                 .def kt4 =r4
                 .def kt5 =r5
                 .def kt6 =r6
                 .def kt7 =r7
                 
                 
                 .def rrn   =r24
                 .def rcnt  =r25
                 
                 .def XL =r26
                 .def XH =r27
                 .def YL =r28
                 .def YH =r29
                 .def ZL =r30
                 .def ZH =r31
                 
                 ;;;****************************************************************************
                 ;;;
                 
                 .MACRO load_column
                 	ldd  row30, Y+ @0 + 0
                 	ldd  row31, Y+ @0 + 1
                 	ldd  row32, Y+ @0 + 2
                 	ldd  row33, Y+ @0 + 3
                 	
                 	ldd  row20, Y+ @0 + 4
                 	ldd  row21, Y+ @0 + 5
                 	ldd  row22, Y+ @0 + 6
                 	ldd  row23, Y+ @0 + 7
                 	
                 	ldd  row10, Y+ @0 + 8 
                 	ldd  row11, Y+ @0 + 9 
                 	ldd  row12, Y+ @0 + 10
                 	ldd  row13, Y+ @0 + 11
                 	
                 	ldd  row00, Y+ @0 + 12
                 	ldd  row01, Y+ @0 + 13
                 	ldd  row02, Y+ @0 + 14
                 	ldd  row03, Y+ @0 + 15
                 .ENDMACRO
                 
                 .MACRO store_column
                 	std  Y+ @0 + 15, row03
                 	std  Y+ @0 + 14, row02
                 	std  Y+ @0 + 13, row01
                 	std  Y+ @0 + 12, row00
                 
                 	std  Y+ @0 + 11, row13
                 	std  Y+ @0 + 10, row12
                 	std  Y+ @0 + 9 , row11
                 	std  Y+ @0 + 8 , row10
                 
                 	std  Y+ @0 + 7 , row23
                 	std  Y+ @0 + 6 , row22
                 	std  Y+ @0 + 5 , row21
                 	std  Y+ @0 + 4 , row20
                 
                 	std  Y+ @0 + 3 , row33
                 	std  Y+ @0 + 2 , row32
                 	std  Y+ @0 + 1 , row31
                 	std  Y+ @0 + 0 , row30
                 .ENDMACRO
                 
                 
                 .MACRO key_rc
                 	lpm kt0, Z+				; 1 ins, 3 clocks
                 	ld  k0, Y
                 	eor k0, kt0
                 	st	Y+, k0
                 .ENDMACRO
                 
                 .MACRO key_rc_oneRound
                 	key_rc
                 	key_rc
                 	key_rc
                 	key_rc
                 	key_rc
                 	key_rc
                 	key_rc
                 	key_rc
                 .ENDMACRO
                 
                 .MACRO key_01
                 	ld  kt0, Z+
                 	ld  k0, Y
                 	eor k0, kt0
                 	st  Y+, k0
                 .ENDMACRO
                 
                 .MACRO key_01_Pre
                 	key_01
                 	key_01
                 	key_01
                 	key_01
                 	key_01
                 	key_01
                 	key_01
                 	key_01
                 .ENDMACRO
                 
                 
                 .MACRO key_rc_01
                 	ld  kt0, Y
                 	eor @0, kt0
                 	ld  kt0, Z+
                 	eor @0, kt0
                 	st  Y+, @0
                 .ENDMACRO
                 
                 .MACRO key_rc_01_Post
                 	ldi XH, high(SRAM_KTEXT0)
                 	ldi XL, low(SRAM_KTEXT0)
                 
                 	ld  k0, X+
                 	ld  k1, X+
                 	ld  k2, X+
                 	ld  k3, X+
                 	ld  k4, X+
                 	ld  k5, X+
                 	ld  k6, X+
                 	ld  k7, X+
                 
                 	bst k0, 0
                 	ror k7
                 	ror k6
                 	ror k5
                 	ror k4
                 	ror k3
                 	ror k2
                 	ror k1
                 	ror k0
                 	bld k7, 7
                 
                 	eor k1, k1
                 	bst k7, 6
                 	bld k1, 0
                 	eor k0, k1
                 
                 	key_rc_01 k0
                 	key_rc_01 k1
                 	key_rc_01 k2
                 	key_rc_01 k3
                 	key_rc_01 k4
                 	key_rc_01 k5
                 	key_rc_01 k6
                 	key_rc_01 k7
                 .ENDMACRO
                 
                 keySchedule:
000008 e0f0      	ldi ZH, high(SRAM_KTEXT0)
000009 eae0      	ldi ZL, low(SRAM_KTEXT0)
00000a e0d0      	ldi YH, high(SRAM_KTEXT1)
00000b eac8      	ldi YL, low(SRAM_KTEXT1)
00000c 9001
00000d 8108
00000e 2500
00000f 9309
000010 9001
000011 8108
000012 2500
000013 9309
000014 9001
000015 8108
000016 2500
000017 9309
000018 9001
000019 8108
00001a 2500
00001b 9309
00001c 9001
00001d 8108
00001e 2500
00001f 9309
000020 9001
000021 8108
000022 2500
000023 9309
000024 9001
000025 8108
000026 2500
000027 9309
000028 9001
000029 8108
00002a 2500
00002b 9309      	key_01_Pre
00002c e0fc      	ldi ZH, high(RC<<1)
00002d efea      	ldi ZL, low(RC<<1)
00002e 9005
00002f 8108
000030 2500
000031 9309
000032 9005
000033 8108
000034 2500
000035 9309
000036 9005
000037 8108
000038 2500
000039 9309
00003a 9005
00003b 8108
00003c 2500
00003d 9309
00003e 9005
00003f 8108
000040 2500
000041 9309
000042 9005
000043 8108
000044 2500
000045 9309
000046 9005
000047 8108
000048 2500
000049 9309
00004a 9005
00004b 8108
00004c 2500
00004d 9309      	key_rc_oneRound ; 1
00004e 9005
00004f 8108
000050 2500
000051 9309
000052 9005
000053 8108
000054 2500
000055 9309
000056 9005
000057 8108
000058 2500
000059 9309
00005a 9005
00005b 8108
00005c 2500
00005d 9309
00005e 9005
00005f 8108
000060 2500
000061 9309
000062 9005
000063 8108
000064 2500
000065 9309
000066 9005
000067 8108
000068 2500
000069 9309
00006a 9005
00006b 8108
00006c 2500
00006d 9309      	key_rc_oneRound ; 2
00006e 9005
00006f 8108
000070 2500
000071 9309
000072 9005
000073 8108
000074 2500
000075 9309
000076 9005
000077 8108
000078 2500
000079 9309
00007a 9005
00007b 8108
00007c 2500
00007d 9309
00007e 9005
00007f 8108
000080 2500
000081 9309
000082 9005
000083 8108
000084 2500
000085 9309
000086 9005
000087 8108
000088 2500
000089 9309
00008a 9005
00008b 8108
00008c 2500
00008d 9309      	key_rc_oneRound ; 3
00008e 9005
00008f 8108
000090 2500
000091 9309
000092 9005
000093 8108
000094 2500
000095 9309
000096 9005
000097 8108
000098 2500
000099 9309
00009a 9005
00009b 8108
00009c 2500
00009d 9309
00009e 9005
00009f 8108
0000a0 2500
0000a1 9309
0000a2 9005
0000a3 8108
0000a4 2500
0000a5 9309
0000a6 9005
0000a7 8108
0000a8 2500
0000a9 9309
0000aa 9005
0000ab 8108
0000ac 2500
0000ad 9309      	key_rc_oneRound ; 4
0000ae 9005
0000af 8108
0000b0 2500
0000b1 9309
0000b2 9005
0000b3 8108
0000b4 2500
0000b5 9309
0000b6 9005
0000b7 8108
0000b8 2500
0000b9 9309
0000ba 9005
0000bb 8108
0000bc 2500
0000bd 9309
0000be 9005
0000bf 8108
0000c0 2500
0000c1 9309
0000c2 9005
0000c3 8108
0000c4 2500
0000c5 9309
0000c6 9005
0000c7 8108
0000c8 2500
0000c9 9309
0000ca 9005
0000cb 8108
0000cc 2500
0000cd 9309      	key_rc_oneRound ; 5
0000ce 9005
0000cf 8108
0000d0 2500
0000d1 9309
0000d2 9005
0000d3 8108
0000d4 2500
0000d5 9309
0000d6 9005
0000d7 8108
0000d8 2500
0000d9 9309
0000da 9005
0000db 8108
0000dc 2500
0000dd 9309
0000de 9005
0000df 8108
0000e0 2500
0000e1 9309
0000e2 9005
0000e3 8108
0000e4 2500
0000e5 9309
0000e6 9005
0000e7 8108
0000e8 2500
0000e9 9309
0000ea 9005
0000eb 8108
0000ec 2500
0000ed 9309      	key_rc_oneRound ; 6
0000ee 9005
0000ef 8108
0000f0 2500
0000f1 9309
0000f2 9005
0000f3 8108
0000f4 2500
0000f5 9309
0000f6 9005
0000f7 8108
0000f8 2500
0000f9 9309
0000fa 9005
0000fb 8108
0000fc 2500
0000fd 9309
0000fe 9005
0000ff 8108
000100 2500
000101 9309
000102 9005
000103 8108
000104 2500
000105 9309
000106 9005
000107 8108
000108 2500
000109 9309
00010a 9005
00010b 8108
00010c 2500
00010d 9309      	key_rc_oneRound ; 7
00010e 9005
00010f 8108
000110 2500
000111 9309
000112 9005
000113 8108
000114 2500
000115 9309
000116 9005
000117 8108
000118 2500
000119 9309
00011a 9005
00011b 8108
00011c 2500
00011d 9309
00011e 9005
00011f 8108
000120 2500
000121 9309
000122 9005
000123 8108
000124 2500
000125 9309
000126 9005
000127 8108
000128 2500
000129 9309
00012a 9005
00012b 8108
00012c 2500
00012d 9309      	key_rc_oneRound ; 8
00012e 9005
00012f 8108
000130 2500
000131 9309
000132 9005
000133 8108
000134 2500
000135 9309
000136 9005
000137 8108
000138 2500
000139 9309
00013a 9005
00013b 8108
00013c 2500
00013d 9309
00013e 9005
00013f 8108
000140 2500
000141 9309
000142 9005
000143 8108
000144 2500
000145 9309
000146 9005
000147 8108
000148 2500
000149 9309
00014a 9005
00014b 8108
00014c 2500
00014d 9309      	key_rc_oneRound ; 9
00014e 9005
00014f 8108
000150 2500
000151 9309
000152 9005
000153 8108
000154 2500
000155 9309
000156 9005
000157 8108
000158 2500
000159 9309
00015a 9005
00015b 8108
00015c 2500
00015d 9309
00015e 9005
00015f 8108
000160 2500
000161 9309
000162 9005
000163 8108
000164 2500
000165 9309
000166 9005
000167 8108
000168 2500
000169 9309
00016a 9005
00016b 8108
00016c 2500
00016d 9309      	key_rc_oneRound ; 10
00016e e0b0
00016f eaa0
000170 910d
000171 911d
000172 912d
000173 913d
000174 914d
000175 915d
000176 916d
000177 917d
000178 fb00
000179 9577
00017a 9567
00017b 9557
00017c 9547
00017d 9537
00017e 9527
00017f 9517
000180 9507
000181 f977
000182 2711
000183 fb76
000184 f910
000185 2701
000186 8008
000187 2500
000188 9001
000189 2500
00018a 9309
00018b 8008
00018c 2510
00018d 9001
00018e 2510
00018f 9319
000190 8008
000191 2520
000192 9001
000193 2520
000194 9329
000195 8008
000196 2530
000197 9001
000198 2530
000199 9339
00019a 8008
00019b 2540
00019c 9001
00019d 2540
00019e 9349
00019f 8008
0001a0 2550
0001a1 9001
0001a2 2550
0001a3 9359
0001a4 8008
0001a5 2560
0001a6 9001
0001a7 2560
0001a8 9369
0001a9 8008
0001aa 2570
0001ab 9001
0001ac 2570
0001ad 9379      	key_rc_01_Post  ; 11
0001ae 9508      ret
                 
                 .MACRO columnXor
                 	sbrc @0, 0
                 	com row30
                 	sbrc @0, 1
                 	com row31
                 	sbrc @0, 2
                 	com row32
                 	sbrc @0, 3
                 	com row33
                 
                 	sbrc @0, 4
                 	com row20
                 	sbrc @0, 5
                 	com row21
                 	sbrc @0, 6
                 	com row22
                 	sbrc @0, 7
                 	com row23
                 
                 	sbrc @1, 0
                 	com row10
                 	sbrc @1, 1
                 	com row11
                 	sbrc @1, 2
                 	com row12
                 	sbrc @1, 3
                 	com row13
                 
                 	sbrc @1, 4
                 	com row00
                 	sbrc @1, 5
                 	com row01
                 	sbrc @1, 6
                 	com row02
                 	sbrc @1, 7
                 	com row03
                 .ENDMACRO
                 
                 
                 .MACRO Sbox
                 	; a = row10:row00
                 	; b = row11:row01
                 	; c = row12:row02
                 	; d = row13:row03
                 	movw t0, row00
                 	movw t2, row01
                 	movw t4, row02
                 	eor  row00, row02
                 	eor  row10, row12
                 	com  t2
                 	com  t3
                 	or   row02, t2
                 	or   row12, t3
                 	movw t2, row03
                 	eor  t2, row02
                 	eor  t3, row12
                 	or  row03, row01
                 	or  row13, row11
                 	and row03, t0
                 	and row13, t1
                 	or  row01, t2
                 	or  row11, t3
                 	eor t2, t0
                 	eor t3, t1
                 	and t0, t4
                 	and t1, t5
                 	eor t4, row01
                 	eor t5, row11
                 	eor t2, row03
                 	eor t3, row13
                 	or  row03, row00
                 	or  row13, row10
                 	eor row00, t4
                 	eor row10, t5
                 	or  row02, t2
                 	or  row12, t3
                 	eor row01, row02
                 	eor row11, row03
                 	and row01, t0
                 	and row11, t1
                 
                 	; a = row30:row20
                 	; b = row31:row21
                 	; c = row32:row22
                 	; d = row33:row23
                 	movw t0, row20
                 	movw t2, row21
                 	movw t4, row22
                 	eor  row20, row22
                 	eor  row30, row32
                 	com  t2
                 	com  t3
                 	or   row22, t2
                 	or   row32, t3
                 	movw t2, row23
                 	eor  t2, row22
                 	eor  t3, row32
                 	or  row23, row21
                 	or  row33, row31
                 	and row23, t0
                 	and row33, t1
                 	or  row21, t2
                 	or  row31, t3
                 	eor t2, t0
                 	eor t3, t1
                 	and t0, t4
                 	and t1, t5
                 	eor t4, row21
                 	eor t5, row31
                 	eor t2, row23
                 	eor t3, row33
                 	or  row23, row20
                 	or  row33, row30
                 	eor row20, t4
                 	eor row30, t5
                 	or  row22, t2
                 	or  row32, t3
                 	eor row21, row22
                 	eor row31, row23
                 	and row21, t0
                 	and row31, t1
                 .ENDMACRO
                 
                 .MACRO iSbox
                 	; a = row10:row00
                 	; b = row11:row01
                 	; c = row12:row02
                 	; d = row13:row03
                 	movw t0, row00
                 	and  row00, row01
                 	and  row10, row11
                 	or   row00, row03
                 	or   row10, row13
                 	eor  row00, row02
                 	eor  row10, row12
                 	movw t2, row00
                 	com  row00
                 	com  row10
                 	or   t2, row01
                 	or   t3, row11
                 	eor  t2, row03
                 	eor  t3, row13
                 	or   row03, row00
                 	or   row13, row10
                 	movw t4, t2
                 	or   t2, t0
                 	or   t3, t1
                 	eor  t0, row03
                 	eor  t1, row13
                 	eor  row01, t2
                 	eor  row11, t3
                 	movw row02, row01
                 	eor  row01, t0
                 	eor  row11, t1
                 	movw row03, row01
                 	or   row03, row00
                 	or   row13, row10
                 	and  t0, row03
                 	and  t1, row13
                 	eor  t0, t4
                 	eor  t1, t5
                 	movw row03, t0
                 	and  t0, row02
                 	and  t1, row12
                 	eor  row00, t0
                 	eor  row10, t1
                 
                 	; a = row30:row20
                 	; b = row31:row21
                 	; c = row32:row22
                 	; d = row33:row23
                 	movw t0, row20
                 	and  row20, row21
                 	and  row30, row31
                 	or   row20, row23
                 	or   row30, row33
                 	eor  row20, row22
                 	eor  row30, row32
                 	movw t2, row20
                 	com  row20
                 	com  row30
                 	or   t2, row21
                 	or   t3, row31
                 	eor  t2, row23
                 	eor  t3, row33
                 	or   row23, row20
                 	or   row33, row30
                 	movw t4, t2
                 	or   t2, t0
                 	or   t3, t1
                 	eor  t0, row23
                 	eor  t1, row33
                 	eor  row21, t2
                 	eor  row31, t3
                 	movw row22, row21
                 	eor  row21, t0
                 	eor  row31, t1
                 	movw row23, row21
                 	or   row23, row20
                 	or   row33, row30
                 	and  t0, row23
                 	and  t1, row33
                 	eor  t0, t4
                 	eor  t1, t5
                 	movw row23, t0
                 	and  t0, row22
                 	and  t1, row32
                 	eor  row20, t0
                 	eor  row30, t1
                 .ENDMACRO
                 
                 ;;;****************************************************************************
                 ;;; M_XOR
                 .MACRO M_XOR
                 	mov t0, row00
                 	eor t0, row10
                 	eor t0, row20
                 	eor t0, row30
                 	mov row00, t0
                 	eor row10, t0
                 	eor row20, t0
                 	eor row30, t0
                 
                 	mov t0, row01
                 	eor t0, row11
                 	eor t0, row21
                 	eor t0, row31
                 	mov row01, t0
                 	eor row11, t0
                 	eor row21, t0
                 	eor row31, t0
                 
                 	mov t0, row02
                 	eor t0, row12
                 	eor t0, row22
                 	eor t0, row32
                 	mov row02, t0
                 	eor row12, t0
                 	eor row22, t0
                 	eor row32, t0
                 
                 	mov t0, row03
                 	eor t0, row13
                 	eor t0, row23
                 	eor t0, row33
                 	mov row03, t0
                 	eor row13, t0
                 	eor row23, t0
                 	eor row33, t0
                 .ENDMACRO
                 
                 .MACRO keyxor_column
                 	ld  k0, X+
                 	ld  k1, X+
                 	columnXor k0, k1
                 .ENDMACRO
                 
                 keyxor_column_Sbox_M_XOR:
0001af 910d
0001b0 911d
0001b1 fd00
0001b2 9430
0001b3 fd01
0001b4 9470
0001b5 fd02
0001b6 94b0
0001b7 fd03
0001b8 94f0
0001b9 fd04
0001ba 9420
0001bb fd05
0001bc 9460
0001bd fd06
0001be 94a0
0001bf fd07
0001c0 94e0
0001c1 fd10
0001c2 9410
0001c3 fd11
0001c4 9450
0001c5 fd12
0001c6 9490
0001c7 fd13
0001c8 94d0
0001c9 fd14
0001ca 9400
0001cb fd15
0001cc 9440
0001cd fd16
0001ce 9480
0001cf fd17
0001d0 94c0      	keyxor_column
0001d1 0180
0001d2 0192
0001d3 01a4
0001d4 2408
0001d5 2419
0001d6 9520
0001d7 9530
0001d8 2a82
0001d9 2a93
0001da 0196
0001db 2528
0001dc 2539
0001dd 28c4
0001de 28d5
0001df 22c0
0001e0 22d1
0001e1 2a42
0001e2 2a53
0001e3 2720
0001e4 2731
0001e5 2304
0001e6 2315
0001e7 2544
0001e8 2555
0001e9 252c
0001ea 253d
0001eb 28c0
0001ec 28d1
0001ed 2604
0001ee 2615
0001ef 2a82
0001f0 2a93
0001f1 2448
0001f2 245c
0001f3 2240
0001f4 2251
0001f5 0181
0001f6 0193
0001f7 01a5
0001f8 242a
0001f9 243b
0001fa 9520
0001fb 9530
0001fc 2aa2
0001fd 2ab3
0001fe 0197
0001ff 252a
000200 253b
000201 28e6
000202 28f7
000203 22e0
000204 22f1
000205 2a62
000206 2a73
000207 2720
000208 2731
000209 2304
00020a 2315
00020b 2546
00020c 2557
00020d 252e
00020e 253f
00020f 28e2
000210 28f3
000211 2624
000212 2635
000213 2aa2
000214 2ab3
000215 246a
000216 247e
000217 2260
000218 2271      	Sbox
000219 2d00
00021a 2501
00021b 2502
00021c 2503
00021d 2e00
00021e 2610
00021f 2620
000220 2630
000221 2d04
000222 2505
000223 2506
000224 2507
000225 2e40
000226 2650
000227 2660
000228 2670
000229 2d08
00022a 2509
00022b 250a
00022c 250b
00022d 2e80
00022e 2690
00022f 26a0
000230 26b0
000231 2d0c
000232 250d
000233 250e
000234 250f
000235 2ec0
000236 26d0
000237 26e0
000238 26f0      	M_XOR
000239 9508      ret
                 
                 M_XOR_iSbox_keyxor_column:
00023a 2d00
00023b 2501
00023c 2502
00023d 2503
00023e 2e00
00023f 2610
000240 2620
000241 2630
000242 2d04
000243 2505
000244 2506
000245 2507
000246 2e40
000247 2650
000248 2660
000249 2670
00024a 2d08
00024b 2509
00024c 250a
00024d 250b
00024e 2e80
00024f 2690
000250 26a0
000251 26b0
000252 2d0c
000253 250d
000254 250e
000255 250f
000256 2ec0
000257 26d0
000258 26e0
000259 26f0      	M_XOR
00025a 0180
00025b 2004
00025c 2015
00025d 280c
00025e 281d
00025f 2408
000260 2419
000261 0190
000262 9400
000263 9410
000264 2924
000265 2935
000266 252c
000267 253d
000268 28c0
000269 28d1
00026a 01a9
00026b 2b20
00026c 2b31
00026d 250c
00026e 251d
00026f 2642
000270 2653
000271 0142
000272 2640
000273 2651
000274 0162
000275 28c0
000276 28d1
000277 210c
000278 211d
000279 2704
00027a 2715
00027b 0168
00027c 2108
00027d 2119
00027e 2600
00027f 2611
000280 0181
000281 2026
000282 2037
000283 282e
000284 283f
000285 242a
000286 243b
000287 0191
000288 9420
000289 9430
00028a 2926
00028b 2937
00028c 252e
00028d 253f
00028e 28e2
00028f 28f3
000290 01a9
000291 2b20
000292 2b31
000293 250e
000294 251f
000295 2662
000296 2673
000297 0153
000298 2660
000299 2671
00029a 0173
00029b 28e2
00029c 28f3
00029d 210e
00029e 211f
00029f 2704
0002a0 2715
0002a1 0178
0002a2 210a
0002a3 211b
0002a4 2620
0002a5 2631      	iSbox
0002a6 910d
0002a7 911d
0002a8 fd00
0002a9 9430
0002aa fd01
0002ab 9470
0002ac fd02
0002ad 94b0
0002ae fd03
0002af 94f0
0002b0 fd04
0002b1 9420
0002b2 fd05
0002b3 9460
0002b4 fd06
0002b5 94a0
0002b6 fd07
0002b7 94e0
0002b8 fd10
0002b9 9410
0002ba fd11
0002bb 9450
0002bc fd12
0002bd 9490
0002be fd13
0002bf 94d0
0002c0 fd14
0002c1 9400
0002c2 fd15
0002c3 9440
0002c4 fd16
0002c5 9480
0002c6 fd17
0002c7 94c0      	keyxor_column
0002c8 9508      ret
                 
                 
                 .MACRO storeload_column01_row0
                 	std  Y+12, row00
                 	std  Y+13, row01
                 	std  Y+14, row02
                 	std  Y+15, row03
                 	ldd  row00, Y+16+12
                 	ldd  row01, Y+16+13
                 	ldd  row02, Y+16+14
                 	ldd  row03, Y+16+15
                 .ENDMACRO
                 
                 .MACRO exch
                 	ldd  t0, @0
                 	std  @0, @1
                 	mov  @1, t0
                 .ENDMACRO
                 
                 .MACRO storeload_column01_row1
                 	exch  Y+16+ 8, row10
                 	exch  Y+16+ 9, row11
                 	exch  Y+16+10, row12
                 	exch  Y+16+11, row13
                 .ENDMACRO
                 
                 .MACRO storeload_column01_row2
                 	ldd  t0, Y+32+4
                 	ldd  t1, Y+32+5
                 	ldd  t2, Y+32+6
                 	ldd  t3, Y+32+7
                 	std  Y+32+4, row20
                 	std  Y+32+5, row21
                 	std  Y+32+6, row22
                 	std  Y+32+7, row23
                 	std  Y+4, t0
                 	std  Y+5, t1
                 	std  Y+6, t2
                 	std  Y+7, t3
                 	ldd  row20, Y+16+4
                 	ldd  row21, Y+16+5
                 	ldd  row22, Y+16+6
                 	ldd  row23, Y+16+7
                 .ENDMACRO
                 
                 .MACRO storeload_column01_row3
                 	ldd  t0, Y+48+0
                 	ldd  t1, Y+48+1
                 	ldd  t2, Y+48+2
                 	ldd  t3, Y+48+3
                 	std  Y+48+0, row30
                 	std  Y+48+1, row31
                 	std  Y+48+2, row32
                 	std  Y+48+3, row33
                 
                 	ldd  row30, Y+32+0
                 	ldd  row31, Y+32+1
                 	ldd  row32, Y+32+2
                 	ldd  row33, Y+32+3
                 	std  Y+32+0, t0
                 	std  Y+32+1, t1
                 	std  Y+32+2, t2
                 	std  Y+32+3, t3
                 
                 	ldd  t0, Y+16+0
                 	ldd  t1, Y+16+1
                 	ldd  t2, Y+16+2
                 	ldd  t3, Y+16+3
                 	std  Y+16+0, row30
                 	std  Y+16+1, row31
                 	std  Y+16+2, row32
                 	std  Y+16+3, row33
                 
                 	mov  row30, t0
                 	mov  row31, t1
                 	mov  row32, t2
                 	mov  row33, t3
                 .ENDMACRO
                 
                 .MACRO storeload_column12_row0
                 	std  Y+16+12, row00
                 	std  Y+16+13, row01
                 	std  Y+16+14, row02
                 	std  Y+16+15, row03
                 	ldd  row00, Y+32+12
                 	ldd  row01, Y+32+13
                 	ldd  row02, Y+32+14
                 	ldd  row03, Y+32+15
                 .ENDMACRO
                 
                 .MACRO storeload_column12_row1
                 	exch  Y+32+ 8, row10
                 	exch  Y+32+ 9, row11
                 	exch  Y+32+10, row12
                 	exch  Y+32+11, row13
                 .ENDMACRO
                 
                 .MACRO storeload_column12_row2
                 	ldd  t0, Y+48+4
                 	ldd  t1, Y+48+5
                 	ldd  t2, Y+48+6
                 	ldd  t3, Y+48+7
                 	std  Y+48+4, row20
                 	std  Y+48+5, row21
                 	std  Y+48+6, row22
                 	std  Y+48+7, row23
                 	std  Y+16+4, t0
                 	std  Y+16+5, t1
                 	std  Y+16+6, t2
                 	std  Y+16+7, t3
                 	ldd  row20, Y+4
                 	ldd  row21, Y+5
                 	ldd  row22, Y+6
                 	ldd  row23, Y+7
                 .ENDMACRO
                 
                 .MACRO storeload_column12_row3
                 	std  Y+0, row30
                 	std  Y+1, row31
                 	std  Y+2, row32
                 	std  Y+3, row33
                 	ldd  row30, Y+16+0
                 	ldd  row31, Y+16+1
                 	ldd  row32, Y+16+2
                 	ldd  row33, Y+16+3
                 .ENDMACRO
                 
                 .MACRO storeload_column23_row0
                 	std  Y+32+12, row00
                 	std  Y+32+13, row01
                 	std  Y+32+14, row02
                 	std  Y+32+15, row03
                 	ldd  row00, Y+48+12
                 	ldd  row01, Y+48+13
                 	ldd  row02, Y+48+14
                 	ldd  row03, Y+48+15
                 .ENDMACRO
                 
                 .MACRO storeload_column23_row1
                 	exch  Y+48+ 8, row10
                 	exch  Y+48+ 9, row11
                 	exch  Y+48+10, row12
                 	exch  Y+48+11, row13
                 .ENDMACRO
                 
                 .MACRO storeload_column23_row2
                 	std  Y+4, row20
                 	std  Y+5, row21
                 	std  Y+6, row22
                 	std  Y+7, row23
                 	ldd  row20, Y+16+4
                 	ldd  row21, Y+16+5
                 	ldd  row22, Y+16+6
                 	ldd  row23, Y+16+7
                 .ENDMACRO
                 
                 .MACRO storeload_column23_row3
                 	std  Y+16+0, row30
                 	std  Y+16+1, row31
                 	std  Y+16+2, row32
                 	std  Y+16+3, row33
                 	ldd  row30, Y+32+0
                 	ldd  row31, Y+32+1
                 	ldd  row32, Y+32+2
                 	ldd  row33, Y+32+3
                 .ENDMACRO
                 
                 .MACRO store_column3_row0
                 	std  Y+48+12, row00
                 	std  Y+48+13, row01
                 	std  Y+48+14, row02
                 	std  Y+48+15, row03
                 .ENDMACRO
                 
                 .MACRO store_column3_row1
                 	std  Y+ 8, row10
                 	std  Y+ 9, row11
                 	std  Y+10, row12
                 	std  Y+11, row13
                 .ENDMACRO
                 
                 .MACRO store_column3_row2
                 	std  Y+16+4, row20
                 	std  Y+16+5, row21
                 	std  Y+16+6, row22
                 	std  Y+16+7, row23
                 .ENDMACRO
                 
                 .MACRO store_column3_row3
                 	std  Y+32+0, row30
                 	std  Y+32+1, row31
                 	std  Y+32+2, row32
                 	std  Y+32+3, row33
                 .ENDMACRO
                 
                 .MACRO forward_round
                 	load_column 0
                 
                 	rcall keyxor_column_Sbox_M_XOR
                 	storeload_column01_row0
                 	storeload_column01_row1
                 	storeload_column01_row2
                 	storeload_column01_row3
                 
                 	rcall keyxor_column_Sbox_M_XOR
                 	storeload_column12_row0
                 	storeload_column12_row1
                 	storeload_column12_row2
                 	storeload_column12_row3
                 
                 	rcall keyxor_column_Sbox_M_XOR
                 	storeload_column23_row0
                 	storeload_column23_row1
                 	storeload_column23_row2
                 	storeload_column23_row3
                 
                 	rcall keyxor_column_Sbox_M_XOR
                 	store_column3_row0
                 	store_column3_row1
                 	store_column3_row2
                 	store_column3_row3
                 	inc rcnt
                 .ENDMACRO
                 
                 .MACRO middle_round
                 	movw Z, Y
                 
                 	load_column 0
                 	rcall keyxor_column_Sbox_M_XOR
                 	iSbox
                 	keyxor_column
                 	store_column 0
                 
                 	load_column 1
                 	rcall keyxor_column_Sbox_M_XOR
                 	iSbox
                 	keyxor_column
                 	store_column 1
                 
                 	load_column 2
                 	rcall keyxor_column_Sbox_M_XOR
                 	iSbox
                 	keyxor_column
                 	store_column 2
                 
                 	load_column 3
                 	rcall keyxor_column_Sbox_M_XOR
                 	iSbox
                 	keyxor_column
                 	store_column 3
                 .ENDMACRO
                 
                 
                 .MACRO istoreload_column01_row0
                 	std Y+ 0+12, row00
                 	std Y+ 0+13, row01
                 	std Y+ 0+14, row02
                 	std Y+ 0+15, row03
                 	ldd row00, Y+16+12
                 	ldd row01, Y+16+13
                 	ldd row02, Y+16+14
                 	ldd row03, Y+16+15
                 .ENDMACRO
                 
                 .MACRO istoreload_column01_row1
                 	ldd t0, Y+ 0+8 	
                 	ldd t1, Y+ 0+9 	
                 	ldd t2, Y+ 0+10	
                 	ldd t3, Y+ 0+11
                 	std Y+ 0+8 , row10	
                 	std Y+ 0+9 , row11	
                 	std Y+ 0+10, row12	
                 	std Y+ 0+11, row13
                 	
                 	ldd row10, Y+48+8 	
                 	ldd row11, Y+48+9 	
                 	ldd row12, Y+48+10	
                 	ldd row13, Y+48+11	
                 	std Y+48+8 , t0
                 	std Y+48+9 , t1
                 	std Y+48+10, t2
                 	std Y+48+11, t3
                 
                 	ldd t0, Y+32+8 
                 	ldd t1, Y+32+9 
                 	ldd t2, Y+32+10
                 	ldd t3, Y+32+11
                 	std Y+32+8 , row10
                 	std Y+32+9 , row11
                 	std Y+32+10, row12
                 	std Y+32+11, row13
                 
                 	mov row10, t0
                 	mov row11, t1
                 	mov row12, t2
                 	mov row13, t3
                 .ENDMACRO
                 
                 .MACRO istoreload_column01_row2
                 	ldd  t0, Y+ 0+4
                 	ldd  t1, Y+ 0+5
                 	ldd  t2, Y+ 0+6
                 	ldd  t3, Y+ 0+7
                 	std  Y+0+4, row20
                 	std  Y+0+5, row21
                 	std  Y+0+6, row22
                 	std  Y+0+7, row23
                 	std  Y+32+4, t0
                 	std  Y+32+5, t1
                 	std  Y+32+6, t2
                 	std  Y+32+7, t3
                 	ldd  row20, Y+48+4
                 	ldd  row21, Y+48+5
                 	ldd  row22, Y+48+6
                 	ldd  row23, Y+48+7
                 .ENDMACRO
                 
                 .MACRO istoreload_column01_row3
                 	exch Y+ 0+0, row30
                 	exch Y+ 0+1, row31
                 	exch Y+ 0+2, row32
                 	exch Y+ 0+3, row33
                 .ENDMACRO
                 
                 .MACRO istoreload_column12_row0
                 	std Y+16+12, row00
                 	std Y+16+13, row01
                 	std Y+16+14, row02
                 	std Y+16+15, row03
                 	ldd row00, Y+32+12
                 	ldd row01, Y+32+13
                 	ldd row02, Y+32+14
                 	ldd row03, Y+32+15
                 .ENDMACRO
                 
                 .MACRO istoreload_column12_row1
                 	std Y+16+8 , row10	
                 	std Y+16+9 , row11	
                 	std Y+16+10, row12	
                 	std Y+16+11, row13
                 	ldd row10, Y+32+8 	
                 	ldd row11, Y+32+9 	
                 	ldd row12, Y+32+10	
                 	ldd row13, Y+32+11	
                 .ENDMACRO
                 
                 .MACRO istoreload_column12_row2
                 	ldd  t0, Y+16+4
                 	ldd  t1, Y+16+5
                 	ldd  t2, Y+16+6
                 	ldd  t3, Y+16+7
                 	std  Y+16+4, row20
                 	std  Y+16+5, row21
                 	std  Y+16+6, row22
                 	std  Y+16+7, row23
                 	std  Y+48+4, t0
                 	std  Y+48+5, t1
                 	std  Y+48+6, t2
                 	std  Y+48+7, t3
                 	ldd  row20, Y+32+4
                 	ldd  row21, Y+32+5
                 	ldd  row22, Y+32+6
                 	ldd  row23, Y+32+7
                 .ENDMACRO
                 
                 .MACRO istoreload_column12_row3
                 	exch Y+16+0, row30
                 	exch Y+16+1, row31
                 	exch Y+16+2, row32
                 	exch Y+16+3, row33
                 .ENDMACRO
                 
                 .MACRO istoreload_column23_row0
                 	std Y+32+12, row00
                 	std Y+32+13, row01
                 	std Y+32+14, row02
                 	std Y+32+15, row03
                 	ldd row00, Y+48+12
                 	ldd row01, Y+48+13
                 	ldd row02, Y+48+14
                 	ldd row03, Y+48+15
                 .ENDMACRO
                 
                 .MACRO istoreload_column23_row1
                 	std Y+32+8 , row10	
                 	std Y+32+9 , row11	
                 	std Y+32+10, row12	
                 	std Y+32+11, row13
                 	ldd row10, Y+48+8 	
                 	ldd row11, Y+48+9 	
                 	ldd row12, Y+48+10	
                 	ldd row13, Y+48+11	
                 .ENDMACRO
                 
                 .MACRO istoreload_column23_row2
                 	std  Y+32+4, row20
                 	std  Y+32+5, row21
                 	std  Y+32+6, row22
                 	std  Y+32+7, row23
                 	ldd  row20, Y+48+4
                 	ldd  row21, Y+48+5
                 	ldd  row22, Y+48+6
                 	ldd  row23, Y+48+7
                 .ENDMACRO
                 
                 .MACRO istoreload_column23_row3
                 	exch Y+32+0, row30
                 	exch Y+32+1, row31
                 	exch Y+32+2, row32
                 	exch Y+32+3, row33
                 .ENDMACRO
                 
                 .MACRO istore_column3_row0
                 	std Y+48+12, row00
                 	std Y+48+13, row01
                 	std Y+48+14, row02
                 	std Y+48+15, row03
                 .ENDMACRO
                 
                 .MACRO istore_column3_row1
                 	std Y+48+8 , row10	
                 	std Y+48+9 , row11	
                 	std Y+48+10, row12	
                 	std Y+48+11, row13
                 .ENDMACRO
                 
                 .MACRO istore_column3_row2
                 	std  Y+48+4, row20
                 	std  Y+48+5, row21
                 	std  Y+48+6, row22
                 	std  Y+48+7, row23
                 .ENDMACRO
                 
                 .MACRO istore_column3_row3
                 	std Y+48+0, row30
                 	std Y+48+1, row31
                 	std Y+48+2, row32
                 	std Y+48+3, row33
                 .ENDMACRO
                 
                 .MACRO invert_round
                  	ldd  row30, Y+48+0
                  	ldd  row31, Y+48+1
                  	ldd  row32, Y+48+2
                  	ldd  row33, Y+48+3
                 
                 	ldd  row20, Y+32+4
                 	ldd  row21, Y+32+5
                 	ldd  row22, Y+32+6
                 	ldd  row23, Y+32+7
                 
                 	ldd  row10, Y+16+8 
                 	ldd  row11, Y+16+9 
                 	ldd  row12, Y+16+10
                 	ldd  row13, Y+16+11
                 
                 	ldd  row00, Y+ 0+12
                 	ldd  row01, Y+ 0+13
                 	ldd  row02, Y+ 0+14
                 	ldd  row03, Y+ 0+15
                 
                 	rcall M_XOR_iSbox_keyxor_column
                  	istoreload_column01_row0
                 	istoreload_column01_row1
                 	istoreload_column01_row2
                 	istoreload_column01_row3
                 
                 	rcall M_XOR_iSbox_keyxor_column
                 	istoreload_column12_row0
                 	istoreload_column12_row1
                 	istoreload_column12_row2
                 	istoreload_column12_row3
                 
                 	rcall M_XOR_iSbox_keyxor_column
                 	istoreload_column23_row0
                 	istoreload_column23_row1
                 	istoreload_column23_row2
                 	istoreload_column23_row3
                 
                 	rcall M_XOR_iSbox_keyxor_column
                 	istore_column3_row0
                 	istore_column3_row1
                 	istore_column3_row2
                 	istore_column3_row3
                 
                 	inc rcnt
                 .ENDMACRO
                 
                 ; ;******** R1
                 ; k1 + k0 + RC0
                 ; |
                 ; S
                 ; |
                 ; M
                 ; |
                 ; SR
                 ; 
                 ; ;******** R2
                 ; k1+RC1
                 ; |
                 ; S
                 ; |
                 ; M
                 ; |
                 ; SR
                 ; .
                 ; .
                 ; .
                 ; ;******** R5
                 ; k1+RC4
                 ; |
                 ; S
                 ; |
                 ; M
                 ; |
                 ; SR
                 ; 
                 ; ;******** Rmiddle
                 ; k1+RC5
                 ; |
                 ; S
                 ; |
                 ; M
                 ; |
                 ; iS
                 ; |
                 ; k1+RC6
                 ; 
                 ; 
                 ; ;******** iR1
                 ; iSR
                 ; |
                 ; M
                 ; |
                 ; iS
                 ; |
                 ; k1+RC7
                 ; 
                 ; 
                 ; ;******** iR2
                 ; iSR
                 ; |
                 ; M
                 ; |
                 ; iS
                 ; |
                 ; k1+RC8
                 ; 
                 ; ;******** iR3
                 ; iSR
                 ; |
                 ; M
                 ; |
                 ; iS
                 ; |
                 ; k1+RC9
                 ; 
                 ; ;******** iR4
                 ; iSR
                 ; |
                 ; M
                 ; |
                 ; iS
                 ; |
                 ; k1+RC10
                 ; 
                 ; ;******** iR5
                 ; iSR
                 ; |
                 ; M
                 ; |
                 ; iS
                 ; |
                 ; k1+RC11+k0'
                 
                 #ifdef ENCRYPT
                 encrypt:
0002c9 e085          ldi rrn, 5
0002ca e0b0          ldi XH, high(SRAM_KTEXT1)
0002cb eaa8          ldi XL, low(SRAM_KTEXT1)
0002cc e0d0      	ldi YH, high(SRAM_PTEXT)
0002cd e6c0      	ldi YL, low(SRAM_PTEXT)
0002ce 2799      	clr rcnt
                 forword_encrypt_start:
0002cf 8038
0002d0 8079
0002d1 80ba
0002d2 80fb
0002d3 802c
0002d4 806d
0002d5 80ae
0002d6 80ef
0002d7 8418
0002d8 8459
0002d9 849a
0002da 84db
0002db 840c
0002dc 844d
0002dd 848e
0002de 84cf
0002df decf
0002e0 860c
0002e1 864d
0002e2 868e
0002e3 86cf
0002e4 8c0c
0002e5 8c4d
0002e6 8c8e
0002e7 8ccf
0002e8 8d08
0002e9 8e18
0002ea 2e10
0002eb 8d09
0002ec 8e59
0002ed 2e50
0002ee 8d0a
0002ef 8e9a
0002f0 2e90
0002f1 8d0b
0002f2 8edb
0002f3 2ed0
0002f4 a10c
0002f5 a11d
0002f6 a12e
0002f7 a13f
0002f8 a22c
0002f9 a26d
0002fa a2ae
0002fb a2ef
0002fc 830c
0002fd 831d
0002fe 832e
0002ff 833f
000300 882c
000301 886d
000302 88ae
000303 88ef
000304 a908
000305 a919
000306 a92a
000307 a93b
000308 aa38
000309 aa79
00030a aaba
00030b aafb
00030c a038
00030d a079
00030e a0ba
00030f a0fb
000310 a308
000311 a319
000312 a32a
000313 a33b
000314 8908
000315 8919
000316 892a
000317 893b
000318 8a38
000319 8a79
00031a 8aba
00031b 8afb
00031c 2e30
00031d 2e71
00031e 2eb2
00031f 2ef3
000320 de8e
000321 8e0c
000322 8e4d
000323 8e8e
000324 8ecf
000325 a40c
000326 a44d
000327 a48e
000328 a4cf
000329 a508
00032a a618
00032b 2e10
00032c a509
00032d a659
00032e 2e50
00032f a50a
000330 a69a
000331 2e90
000332 a50b
000333 a6db
000334 2ed0
000335 a90c
000336 a91d
000337 a92e
000338 a93f
000339 aa2c
00033a aa6d
00033b aaae
00033c aaef
00033d 8b0c
00033e 8b1d
00033f 8b2e
000340 8b3f
000341 802c
000342 806d
000343 80ae
000344 80ef
000345 8238
000346 8279
000347 82ba
000348 82fb
000349 8838
00034a 8879
00034b 88ba
00034c 88fb
00034d de61
00034e a60c
00034f a64d
000350 a68e
000351 a6cf
000352 ac0c
000353 ac4d
000354 ac8e
000355 accf
000356 ad08
000357 ae18
000358 2e10
000359 ad09
00035a ae59
00035b 2e50
00035c ad0a
00035d ae9a
00035e 2e90
00035f ad0b
000360 aedb
000361 2ed0
000362 822c
000363 826d
000364 82ae
000365 82ef
000366 882c
000367 886d
000368 88ae
000369 88ef
00036a 8a38
00036b 8a79
00036c 8aba
00036d 8afb
00036e a038
00036f a079
000370 a0ba
000371 a0fb
000372 de3c
000373 ae0c
000374 ae4d
000375 ae8e
000376 aecf
000377 8618
000378 8659
000379 869a
00037a 86db
00037b 8a2c
00037c 8a6d
00037d 8aae
00037e 8aef
00037f a238
000380 a279
000381 a2ba
000382 a2fb
000383 9593          forward_round
000384 1398      	cpse rcnt, rrn
000385 cf49      	rjmp forword_encrypt_start
                 middle_encrypt_start:
000386 01fe
000387 8038
000388 8079
000389 80ba
00038a 80fb
00038b 802c
00038c 806d
00038d 80ae
00038e 80ef
00038f 8418
000390 8459
000391 849a
000392 84db
000393 840c
000394 844d
000395 848e
000396 84cf
000397 de17
000398 0180
000399 2004
00039a 2015
00039b 280c
00039c 281d
00039d 2408
00039e 2419
00039f 0190
0003a0 9400
0003a1 9410
0003a2 2924
0003a3 2935
0003a4 252c
0003a5 253d
0003a6 28c0
0003a7 28d1
0003a8 01a9
0003a9 2b20
0003aa 2b31
0003ab 250c
0003ac 251d
0003ad 2642
0003ae 2653
0003af 0142
0003b0 2640
0003b1 2651
0003b2 0162
0003b3 28c0
0003b4 28d1
0003b5 210c
0003b6 211d
0003b7 2704
0003b8 2715
0003b9 0168
0003ba 2108
0003bb 2119
0003bc 2600
0003bd 2611
0003be 0181
0003bf 2026
0003c0 2037
0003c1 282e
0003c2 283f
0003c3 242a
0003c4 243b
0003c5 0191
0003c6 9420
0003c7 9430
0003c8 2926
0003c9 2937
0003ca 252e
0003cb 253f
0003cc 28e2
0003cd 28f3
0003ce 01a9
0003cf 2b20
0003d0 2b31
0003d1 250e
0003d2 251f
0003d3 2662
0003d4 2673
0003d5 0153
0003d6 2660
0003d7 2671
0003d8 0173
0003d9 28e2
0003da 28f3
0003db 210e
0003dc 211f
0003dd 2704
0003de 2715
0003df 0178
0003e0 210a
0003e1 211b
0003e2 2620
0003e3 2631
0003e4 910d
0003e5 911d
0003e6 fd00
0003e7 9430
0003e8 fd01
0003e9 9470
0003ea fd02
0003eb 94b0
0003ec fd03
0003ed 94f0
0003ee fd04
0003ef 9420
0003f0 fd05
0003f1 9460
0003f2 fd06
0003f3 94a0
0003f4 fd07
0003f5 94e0
0003f6 fd10
0003f7 9410
0003f8 fd11
0003f9 9450
0003fa fd12
0003fb 9490
0003fc fd13
0003fd 94d0
0003fe fd14
0003ff 9400
000400 fd15
000401 9440
000402 fd16
000403 9480
000404 fd17
000405 94c0
000406 86cf
000407 868e
000408 864d
000409 860c
00040a 86db
00040b 869a
00040c 8659
00040d 8618
00040e 82ef
00040f 82ae
000410 826d
000411 822c
000412 82fb
000413 82ba
000414 8279
000415 8238
000416 8039
000417 807a
000418 80bb
000419 80fc
00041a 802d
00041b 806e
00041c 80af
00041d 84e8
00041e 8419
00041f 845a
000420 849b
000421 84dc
000422 840d
000423 844e
000424 848f
000425 88c8
000426 dd88
000427 0180
000428 2004
000429 2015
00042a 280c
00042b 281d
00042c 2408
00042d 2419
00042e 0190
00042f 9400
000430 9410
000431 2924
000432 2935
000433 252c
000434 253d
000435 28c0
000436 28d1
000437 01a9
000438 2b20
000439 2b31
00043a 250c
00043b 251d
00043c 2642
00043d 2653
00043e 0142
00043f 2640
000440 2651
000441 0162
000442 28c0
000443 28d1
000444 210c
000445 211d
000446 2704
000447 2715
000448 0168
000449 2108
00044a 2119
00044b 2600
00044c 2611
00044d 0181
00044e 2026
00044f 2037
000450 282e
000451 283f
000452 242a
000453 243b
000454 0191
000455 9420
000456 9430
000457 2926
000458 2937
000459 252e
00045a 253f
00045b 28e2
00045c 28f3
00045d 01a9
00045e 2b20
00045f 2b31
000460 250e
000461 251f
000462 2662
000463 2673
000464 0153
000465 2660
000466 2671
000467 0173
000468 28e2
000469 28f3
00046a 210e
00046b 211f
00046c 2704
00046d 2715
00046e 0178
00046f 210a
000470 211b
000471 2620
000472 2631
000473 910d
000474 911d
000475 fd00
000476 9430
000477 fd01
000478 9470
000479 fd02
00047a 94b0
00047b fd03
00047c 94f0
00047d fd04
00047e 9420
00047f fd05
000480 9460
000481 fd06
000482 94a0
000483 fd07
000484 94e0
000485 fd10
000486 9410
000487 fd11
000488 9450
000489 fd12
00048a 9490
00048b fd13
00048c 94d0
00048d fd14
00048e 9400
00048f fd15
000490 9440
000491 fd16
000492 9480
000493 fd17
000494 94c0
000495 8ac8
000496 868f
000497 864e
000498 860d
000499 86dc
00049a 869b
00049b 865a
00049c 8619
00049d 86e8
00049e 82af
00049f 826e
0004a0 822d
0004a1 82fc
0004a2 82bb
0004a3 827a
0004a4 8239
0004a5 803a
0004a6 807b
0004a7 80bc
0004a8 80fd
0004a9 802e
0004aa 806f
0004ab 84a8
0004ac 84e9
0004ad 841a
0004ae 845b
0004af 849c
0004b0 84dd
0004b1 840e
0004b2 844f
0004b3 8888
0004b4 88c9
0004b5 dcf9
0004b6 0180
0004b7 2004
0004b8 2015
0004b9 280c
0004ba 281d
0004bb 2408
0004bc 2419
0004bd 0190
0004be 9400
0004bf 9410
0004c0 2924
0004c1 2935
0004c2 252c
0004c3 253d
0004c4 28c0
0004c5 28d1
0004c6 01a9
0004c7 2b20
0004c8 2b31
0004c9 250c
0004ca 251d
0004cb 2642
0004cc 2653
0004cd 0142
0004ce 2640
0004cf 2651
0004d0 0162
0004d1 28c0
0004d2 28d1
0004d3 210c
0004d4 211d
0004d5 2704
0004d6 2715
0004d7 0168
0004d8 2108
0004d9 2119
0004da 2600
0004db 2611
0004dc 0181
0004dd 2026
0004de 2037
0004df 282e
0004e0 283f
0004e1 242a
0004e2 243b
0004e3 0191
0004e4 9420
0004e5 9430
0004e6 2926
0004e7 2937
0004e8 252e
0004e9 253f
0004ea 28e2
0004eb 28f3
0004ec 01a9
0004ed 2b20
0004ee 2b31
0004ef 250e
0004f0 251f
0004f1 2662
0004f2 2673
0004f3 0153
0004f4 2660
0004f5 2671
0004f6 0173
0004f7 28e2
0004f8 28f3
0004f9 210e
0004fa 211f
0004fb 2704
0004fc 2715
0004fd 0178
0004fe 210a
0004ff 211b
000500 2620
000501 2631
000502 910d
000503 911d
000504 fd00
000505 9430
000506 fd01
000507 9470
000508 fd02
000509 94b0
00050a fd03
00050b 94f0
00050c fd04
00050d 9420
00050e fd05
00050f 9460
000510 fd06
000511 94a0
000512 fd07
000513 94e0
000514 fd10
000515 9410
000516 fd11
000517 9450
000518 fd12
000519 9490
00051a fd13
00051b 94d0
00051c fd14
00051d 9400
00051e fd15
00051f 9440
000520 fd16
000521 9480
000522 fd17
000523 94c0
000524 8ac9
000525 8a88
000526 864f
000527 860e
000528 86dd
000529 869c
00052a 865b
00052b 861a
00052c 86e9
00052d 86a8
00052e 826f
00052f 822e
000530 82fd
000531 82bc
000532 827b
000533 823a
000534 803b
000535 807c
000536 80bd
000537 80fe
000538 802f
000539 8468
00053a 84a9
00053b 84ea
00053c 841b
00053d 845c
00053e 849d
00053f 84de
000540 840f
000541 8848
000542 8889
000543 88ca
000544 dc6a
000545 0180
000546 2004
000547 2015
000548 280c
000549 281d
00054a 2408
00054b 2419
00054c 0190
00054d 9400
00054e 9410
00054f 2924
000550 2935
000551 252c
000552 253d
000553 28c0
000554 28d1
000555 01a9
000556 2b20
000557 2b31
000558 250c
000559 251d
00055a 2642
00055b 2653
00055c 0142
00055d 2640
00055e 2651
00055f 0162
000560 28c0
000561 28d1
000562 210c
000563 211d
000564 2704
000565 2715
000566 0168
000567 2108
000568 2119
000569 2600
00056a 2611
00056b 0181
00056c 2026
00056d 2037
00056e 282e
00056f 283f
000570 242a
000571 243b
000572 0191
000573 9420
000574 9430
000575 2926
000576 2937
000577 252e
000578 253f
000579 28e2
00057a 28f3
00057b 01a9
00057c 2b20
00057d 2b31
00057e 250e
00057f 251f
000580 2662
000581 2673
000582 0153
000583 2660
000584 2671
000585 0173
000586 28e2
000587 28f3
000588 210e
000589 211f
00058a 2704
00058b 2715
00058c 0178
00058d 210a
00058e 211b
00058f 2620
000590 2631
000591 910d
000592 911d
000593 fd00
000594 9430
000595 fd01
000596 9470
000597 fd02
000598 94b0
000599 fd03
00059a 94f0
00059b fd04
00059c 9420
00059d fd05
00059e 9460
00059f fd06
0005a0 94a0
0005a1 fd07
0005a2 94e0
0005a3 fd10
0005a4 9410
0005a5 fd11
0005a6 9450
0005a7 fd12
0005a8 9490
0005a9 fd13
0005aa 94d0
0005ab fd14
0005ac 9400
0005ad fd15
0005ae 9440
0005af fd16
0005b0 9480
0005b1 fd17
0005b2 94c0
0005b3 8aca
0005b4 8a89
0005b5 8a48
0005b6 860f
0005b7 86de
0005b8 869d
0005b9 865c
0005ba 861b
0005bb 86ea
0005bc 86a9
0005bd 8668
0005be 822f
0005bf 82fe
0005c0 82bd
0005c1 827c
0005c2 823b      	middle_round
0005c3 e085      	ldi rrn, 5
0005c4 2799      	clr rcnt
                 invert_encrypt_start:
0005c5 a838
0005c6 a879
0005c7 a8ba
0005c8 a8fb
0005c9 a02c
0005ca a06d
0005cb a0ae
0005cc a0ef
0005cd 8c18
0005ce 8c59
0005cf 8c9a
0005d0 8cdb
0005d1 840c
0005d2 844d
0005d3 848e
0005d4 84cf
0005d5 dc64
0005d6 860c
0005d7 864d
0005d8 868e
0005d9 86cf
0005da 8c0c
0005db 8c4d
0005dc 8c8e
0005dd 8ccf
0005de 8508
0005df 8519
0005e0 852a
0005e1 853b
0005e2 8618
0005e3 8659
0005e4 869a
0005e5 86db
0005e6 ac18
0005e7 ac59
0005e8 ac9a
0005e9 acdb
0005ea af08
0005eb af19
0005ec af2a
0005ed af3b
0005ee a508
0005ef a519
0005f0 a52a
0005f1 a53b
0005f2 a618
0005f3 a659
0005f4 a69a
0005f5 a6db
0005f6 2e10
0005f7 2e51
0005f8 2e92
0005f9 2ed3
0005fa 810c
0005fb 811d
0005fc 812e
0005fd 813f
0005fe 822c
0005ff 826d
000600 82ae
000601 82ef
000602 a30c
000603 a31d
000604 a32e
000605 a33f
000606 a82c
000607 a86d
000608 a8ae
000609 a8ef
00060a 8108
00060b 8238
00060c 2e30
00060d 8109
00060e 8279
00060f 2e70
000610 810a
000611 82ba
000612 2eb0
000613 810b
000614 82fb
000615 2ef0
000616 dc23
000617 8e0c
000618 8e4d
000619 8e8e
00061a 8ecf
00061b a40c
00061c a44d
00061d a48e
00061e a4cf
00061f 8e18
000620 8e59
000621 8e9a
000622 8edb
000623 a418
000624 a459
000625 a49a
000626 a4db
000627 890c
000628 891d
000629 892e
00062a 893f
00062b 8a2c
00062c 8a6d
00062d 8aae
00062e 8aef
00062f ab0c
000630 ab1d
000631 ab2e
000632 ab3f
000633 a02c
000634 a06d
000635 a0ae
000636 a0ef
000637 8908
000638 8a38
000639 2e30
00063a 8909
00063b 8a79
00063c 2e70
00063d 890a
00063e 8aba
00063f 2eb0
000640 890b
000641 8afb
000642 2ef0
000643 dbf6
000644 a60c
000645 a64d
000646 a68e
000647 a6cf
000648 ac0c
000649 ac4d
00064a ac8e
00064b accf
00064c a618
00064d a659
00064e a69a
00064f a6db
000650 ac18
000651 ac59
000652 ac9a
000653 acdb
000654 a22c
000655 a26d
000656 a2ae
000657 a2ef
000658 a82c
000659 a86d
00065a a8ae
00065b a8ef
00065c a108
00065d a238
00065e 2e30
00065f a109
000660 a279
000661 2e70
000662 a10a
000663 a2ba
000664 2eb0
000665 a10b
000666 a2fb
000667 2ef0
000668 dbd1
000669 ae0c
00066a ae4d
00066b ae8e
00066c aecf
00066d ae18
00066e ae59
00066f ae9a
000670 aedb
000671 aa2c
000672 aa6d
000673 aaae
000674 aaef
000675 aa38
000676 aa79
000677 aaba
000678 aafb
000679 9593          invert_round
00067a 1398      	cpse rcnt, rrn
00067b cf49      	rjmp invert_encrypt_start
00067c 9508      ret
                 #endif
                 
                 RC:
00067d 0301
00067e 0901
00067f 0a08
000680 0e02
000681 0300
000682 0007
000683 0307
000684 0404      .db $01, $03, $01, $09, $08, $0A, $02, $0E, $00, $03, $07, $00, $07, $03, $04, $04
000685 040a
000686 0900
000687 0803
000688 0202
000689 0902
00068a 0f09
00068b 0103
00068c 000d      .db $0A, $04, $00, $09, $03, $08, $02, $02, $02, $09, $09, $0F, $03, $01, $0D, $00
00068d 0800
00068e 0e02
00068f 0a0f
000690 0809
000691 0c0e
000692 0e04
000693 0c06
000694 0908      .db $00, $08, $02, $0E, $0F, $0A, $09, $08, $0E, $0C, $04, $0E, $06, $0C, $08, $09
000695 0504
000696 0802
000697 0102
000698 060e
000699 0803
00069a 000d
00069b 0301
00069c 0707      .db $04, $05, $02, $08, $02, $01, $0E, $06, $03, $08, $0D, $00, $01, $03, $07, $07
00069d 0e0b
00069e 0405
00069f 0606
0006a0 0f0c
0006a1 0403
0006a2 090e
0006a3 0c00
0006a4 0c06      .db $0B, $0E, $05, $04, $06, $06, $0C, $0F, $03, $04, $0E, $09, $00, $0C, $06, $0C
0006a5 0e07
0006a6 080f
0006a7 0f04
0006a8 0807
0006a9 0d0f
0006aa 0509
0006ab 0c05
0006ac 010b      .db $07, $0E, $0F, $08, $04, $0F, $07, $08, $0F, $0D, $09, $05, $05, $0C, $0B, $01
0006ad 0508
0006ae 0408
0006af 0800
0006b0 0105
0006b1 010f
0006b2 0c0a
0006b3 0304
0006b4 0a0a      .db $08, $05, $08, $04, $00, $08, $05, $01, $0F, $01, $0A, $0C, $04, $03, $0A, $0A
0006b5 080c
0006b6 0208
0006b7 030d
0006b8 0f02
0006b9 0502
0006ba 0203
0006bb 0c03
0006bc 0405      .db $0C, $08, $08, $02, $0D, $03, $02, $0F, $02, $05, $03, $02, $03, $0C, $05, $04
0006bd 0406
0006be 050a
0006bf 0101
0006c0 0509
0006c1 000e
0006c2 030e
0006c3 0106
0006c4 0d00      .db $06, $04, $0A, $05, $01, $01, $09, $05, $0E, $00, $0E, $03, $06, $01, $00, $0D
0006c5 030d
0006c6 050b
0006c7 030a
0006c8 0909
0006c9 0a0c
0006ca 0c00
0006cb 0302
0006cc 0909      .db $0D, $03, $0B, $05, $0A, $03, $09, $09, $0C, $0A, $00, $0C, $02, $03, $09, $09
0006cd 000c
0006ce 0c0a
0006cf 0902
0006d0 070b
0006d1 090c
0006d2 0c07
0006d3 0005
0006d4 0d0d      .db $0C, $00, $0A, $0C, $02, $09, $0B, $07, $0C, $09, $07, $0C, $05, $00, $0D, $0D
                 #elif desxl
                 #elif hight
                 #elif idea
                 #elif kasumi
                 #elif katan
                 #elif klein
                 #elif mcrypton
                 #elif noekeon
                 #elif present
                 #elif sea
                 #elif tea
                 #else
                 #endif
                 
                 
                 .CSEG
                 
                 ;******************** FUNCTIONS ***********************************
                 ; This function copy bytes from ROM location pointed by ZH:ZL to
                 ; SRAM location pointed by XH:XL
                 ;	Z must contain source address
                 ;	X must contain destination address
                 ;	r18 must contain the number of byte to copy
                 ;	r16 is used for internal computation
                 copy_word:
0006d5 9105      	lpm		r16, Z+
0006d6 930d      	st 		X+,r16
0006d7 952a      	dec		r18
0006d8 f7e1      	brbc	1, copy_word
0006d9 9508      	ret
                 ;*******************************************************************
                 
                 ;******************** Q ELEC FUNCTIONS (START) *********************
                 ; wait : ret + 0xFF * (5*nop + 1*dec + 1*brbc)
                 wait:
0006da ef0f      	ldi		r16, 0xFF	;r16=FF
                 w_loop:
0006db 0000      	nop
0006dc 0000      	nop
0006dd 0000      	nop
0006de 0000      	nop
0006df 0000      	nop
0006e0 950a      	dec		r16			; r16=r16-1
0006e1 f7c9      	brbc	1,w_loop	; branch sur loop si Z=0, cs si r16 != 0
0006e2 9508      	ret					; return from subroutine
                 
                 
                 
                 ; wait2 : r17 * wait (to be set inside) + some instructions
                 wait2:
0006e3 ef1f      	ldi		r17, 0xFF	;
                 w_loop2:
0006e4 dff5      	rcall	wait
0006e5 951a      	dec		r17			; r17=r17-1
0006e6 f7e9      	brbc	1,w_loop2	; branch sur loop2 si Z=0, cs si r17 != 0
0006e7 9508      	ret					; return from subroutine
                 ;******************** Q ELEC FUNCTIONS (END) *********************
                 
                 
                 ;******************** MAIN (START) *******************************
                 main:
                 	;LOAD THE PTEXT FROM THE DB BELOW TO SRAM
0006e8 e0fe      	ldi		ZH, high(text<<1)
0006e9 e7e6      	ldi		ZL, low(text<<1)
0006ea e0b0      	ldi 	XH, high(SRAM_PTEXT)
0006eb e6a0      	ldi 	XL, low(SRAM_PTEXT)
0006ec e420      	ldi		r18, PTEXT_NUM_BYTE
0006ed dfe7      	rcall	copy_word
                 
                 main_loop:
                 
                 	;LOAD THE KEY FROM THE DB BELOW TO SRAM
0006ee e0fe      	ldi		ZH, high(key<<1)
0006ef e7ee      	ldi		ZL, low(key<<1)
0006f0 e0b0      	ldi 	XH, high(SRAM_KTEXT0)
0006f1 eaa0      	ldi 	XL, low(SRAM_KTEXT0)
0006f2 e028      	ldi		r18, KEY0_NUM_BYTE
0006f3 dfe1      	rcall	copy_word
0006f4 e0fe      	ldi		ZH, high(key<<1)
0006f5 e7ee      	ldi		ZL, low(key<<1)
0006f6 9638      	adiw	Z, 8
0006f7 e0b0      	ldi 	XH, high(SRAM_KTEXT1)
0006f8 eaa8      	ldi 	XL, low(SRAM_KTEXT1)
0006f9 e028      	ldi		r18, KEY0_NUM_BYTE
0006fa dfda      	rcall	copy_word
                 
                 	; Initialize XH:XL with start address of ptext/key memory location
0006fb e0b0      	ldi 	XH, high(SRAM_PTEXT)
0006fc e6a0      	ldi 	XL, low(SRAM_PTEXT)
0006fd 9ac1      	sbi		PORTB,1		; portA,0 = high (trigger on port A0)
0006fe 0000      	nop
0006ff 0000      	nop
000700 0000      	nop
000701 0000      	nop
000702 98c1       	cbi		PORTB,1		; portA,0 = low
000703 0000      	nop
000704 0000      	nop
000705 0000      	nop
                 
                 #ifdef KEYSCHEDULE
000706 d901      	rcall keySchedule
                 #endif
000707 0000      	nop
000708 0000      	nop
000709 0000      	nop
00070a 0000      	nop
00070b 0000      	nop
00070c 0000      	nop
00070d 0000      	nop
00070e 0000      	nop
00070f 0000      	nop
000710 0000      	nop
                 
                 
                 #ifdef ENCRYPT	
000711 dbb7      	rcall	encrypt		; encryption routine
                 #endif
                 	
                 	;LOAD THE KEY FROM THE DB BELOW TO SRAM
000712 e0fe      	ldi		ZH, high(key<<1)
000713 e7ee      	ldi		ZL, low(key<<1)
000714 e0b0      	ldi 	XH, high(SRAM_KTEXT0)
000715 eaa0      	ldi 	XL, low(SRAM_KTEXT0)
000716 e028      	ldi		r18, KEY0_NUM_BYTE
000717 dfbd      	rcall	copy_word
000718 e0fe      	ldi		ZH, high(key<<1)
000719 e7ee      	ldi		ZL, low(key<<1)
00071a 9638      	adiw	Z, 8
00071b e0b0      	ldi 	XH, high(SRAM_KTEXT1)
00071c eaa8      	ldi 	XL, low(SRAM_KTEXT1)
00071d e028      	ldi		r18, KEY0_NUM_BYTE
00071e dfb6      	rcall	copy_word
                 	
                 	
00071f 0000      	nop
000720 0000      	nop
000721 0000      	nop
000722 0000      	nop
000723 0000      	nop
000724 0000      	nop
000725 0000      	nop
000726 0000      	nop
000727 0000      	nop
000728 0000      	nop
                 
                 #ifdef DECRYPT
                 #endif
                 
000729 0000      	nop
00072a 0000      	nop
00072b 0000      	nop
00072c 0000      	nop
00072d 0000      	nop
00072e 0000      	nop
00072f 0000      	nop
000730 0000      	nop
000731 0000      	nop
000732 0000      	nop
                 
000733 9ac0      	sbi		PORTB,0		; portA,0 = high (trigger on port A0)
000734 0000      	nop
000735 0000      	nop
000736 0000      	nop
000737 0000      	nop
000738 98c0       	cbi		PORTB,0		; portA,0 = low
                 
                 
                 	;make a pause
000739 dfa9      	rcall	wait2
00073a dfa8      	rcall	wait2
                 ;	rcall	wait2
                 ;	rcall	wait2
                 ;	rcall	wait2
                 
                 	;encrypt again, with the cipher as the new plain
                 	;rjmp	main_loop
                 
                 	;to decrypt:
                 	;ldi 	XH, high(SRAM_DATA)
                 	;ldi 	XL, low(SRAM_DATA)
                 	;rcall decrypt		; call decryption routine
                 
                 	;rjmp	main	;let's have fun one more time
                 
                 ;text:
                 ;.db $32,$43,$f6,$a8,$88,$5a,$30,$8d,$31,$31,$98,$a2,$e0,$37,$07,$34
                 ;key:
                 ;.db $2b,$7e,$15,$16,$28,$ae,$d2,$a6,$ab,$f7,$15,$88,$09,$cf,$4f,$3c,$51,$a4,$6b,$8d,$31,$1f,$f4,$37
                 
                 ;text:
                 ;.db $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff
                 ;key:
                 ;.db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00
                 
                 text:
                 ;.db $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff
00073b 0000
00073c 0000
00073d 0000
00073e 0000      .db $00,$00,$00,$00,$00,$00,$00,$00
                 key:
00073f 0000
000740 0000
000741 0000
000742 0000
000743 0000
000744 0000
000745 0000
000746 0000      .db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
                 ;key:
                 ;.db $FE, $DC, $BA, $98, $76, $54, $32, $10, $83, $77, $AB, $69, $5D, $EE, $FC, $01
                 
                 ;text:
                 ;.db $7f,$f5,$fc,$04,$a5,$bc,$9e,$0a
                 ;key:
                 ;.db $ea,$85,$be,$fc,$86,$c6,$f1,$47,$c7,$ff,$7d,$7b,$88,$20,$83,$02
                 ;
                 ;b4db77b7e2560859
                 ;.db $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff
                 ;ce 4d 0d b1 21 01 fb f7 0f 40 10 00
                 ;text:
                 ;.db $59,$08,$56,$e2,$b7,$77,$db,$b4
                 ;key:
                 ;.db $ce,$4d,$1d,$1b,$12,$fb,$f7,$0f,$04,$01
                 
                 
                 .DSEG
                 ;.ORG 0x60
000060             SRAM_PTEXT: .BYTE PTEXT_NUM_BYTE
0000a0             SRAM_KTEXT0: .BYTE KEY0_NUM_BYTE
0000a8             SRAM_KTEXT1: .BYTE KEY1_NUM_BYTE
                 
                 
                 ;******************** MAIN (END) *********************************
                 
                 


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

"ATtiny45" register use summary:
r0 : 291 r1 :  74 r2 :  83 r3 :  74 r4 :  70 r5 :  61 r6 :  70 r7 :  61 
r8 :  55 r9 :  50 r10:  55 r11:  50 r12:  80 r13:  70 r14:  80 r15:  70 
r16: 559 r17: 159 r18: 105 r19:  75 r20:  33 r21:  21 r22:   5 r23:   7 
r24:   4 r25:   6 r26:   8 r27:   8 r28:   2 r29:   2 r30:   7 r31:  11 
x  :  21 y  : 641 z  : 100 
Registers used: 35 out of 35 (100.0%)

"ATtiny45" instruction use summary:
.lds  :   0 .sts  :   0 adc   :   0 add   :   0 adiw  :   2 and   :  72 
andi  :   0 asr   :   0 bclr  :   0 bld   :   2 brbc  :   3 brbs  :   0 
brcc  :   0 brcs  :   0 break :   0 breq  :   0 brge  :   0 brhc  :   0 
brhs  :   0 brid  :   0 brie  :   0 brlo  :   0 brlt  :   0 brmi  :   0 
brne  :   0 brpl  :   0 brsh  :   0 brtc  :   0 brts  :   0 brvc  :   0 
brvs  :   0 bset  :   0 bst   :   2 cbi   :   2 cbr   :   0 clc   :   0 
clh   :   0 cli   :   1 cln   :   0 clr   :   2 cls   :   0 clt   :   0 
clv   :   0 clz   :   0 com   : 120 cp    :   0 cpc   :   0 cpi   :   0 
cpse  :   2 dec   :   3 eor   : 322 icall :   0 ijmp  :   0 in    :   0 
inc   :   2 ld    : 132 ldd   : 224 ldi   :  46 lds   :   0 lpm   :  81 
lsl   :   0 lsr   :   0 mov   :  48 movw  :  69 neg   :   0 nop   :  46 
or    : 120 ori   :   0 out   :   3 pop   :   0 push  :   0 rcall :  22 
ret   :   7 reti  :   0 rjmp  :   3 rol   :   0 ror   :   8 sbc   :   0 
sbci  :   0 sbi   :   2 sbic  :   0 sbis  :   0 sbiw  :   0 sbr   :   0 
sbrc  :  96 sbrs  :   0 sec   :   0 seh   :   0 sei   :   0 sen   :   0 
ser   :   0 ses   :   0 set   :   0 sev   :   0 sez   :   0 sleep :   0 
spm   :   0 st    :  97 std   : 224 sts   :   0 sub   :   0 subi  :   0 
swap  :   0 tst   :   0 wdr   :   0 
Instructions used: 30 out of 105 (28.6%)

"ATtiny45" memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x000e8e   3526    200   3726    4096  91.0%
[.dseg] 0x000060 0x000108      0    168    168     256  65.6%
[.eseg] 0x000000 0x000000      0      0      0     256   0.0%

Assembly complete, 0 errors, 26 warnings
